<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.35">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2024-11-20">
<title>MPA abstract analysis â€“ Representation Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../background/study_stim.html" rel="next">
<link href="../misc/ordinal.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-383d4a065b21370043bc4709e21900a7.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-22ab91ee63bfb1fa4abd865bfe32346b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="../assets/style_qt.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Representation Study</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tegorman13/Representation_Study"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../background/bg.html"> 
<span class="menu-text">Study Info</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../nb/analysis.html"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../paper.html" aria-current="page"> 
<span class="menu-text">Paper</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../nb/study1.html"><strong>Analysis</strong></a></li><li class="breadcrumb-item"><a href="../mpa/mpa_analysis.html">MPA</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Paper</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Manuscript</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mpa/mpa_abstract.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">MPA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Analysis</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nb/study1.html" class="sidebar-item-text sidebar-link"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Study 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nb/study2.html" class="sidebar-item-text sidebar-link"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Study 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nb/results.html" class="sidebar-item-text sidebar-link"><i class="bi bi-bar-chart-fill" role="img">
</i> 
 <span class="menu-text">Results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nb/overview.html" class="sidebar-item-text sidebar-link"><i class="bi bi-signpost-split-fill" role="img">
</i> 
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/outlier.html" class="sidebar-item-text sidebar-link"><i class="bi bi-graph-down" role="img">
</i> 
 <span class="menu-text">Outliers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/indiv.html" class="sidebar-item-text sidebar-link"><i class="bi bi-bar-chart-steps" role="img">
</i> 
 <span class="menu-text">Response Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/discrep.html" class="sidebar-item-text sidebar-link"><i class="bi bi-columns-gap" role="img">
</i> 
 <span class="menu-text">Discrep_Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/ordinal.html" class="sidebar-item-text sidebar-link"><i class="bi bi-grid-3x2-gap-fill" role="img">
</i> 
 <span class="menu-text">Ordinal Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mpa/mpa_analysis.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-clipboard" role="img">
</i> 
 <span class="menu-text">MPA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Background</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/study_stim.html" class="sidebar-item-text sidebar-link"><i class="bi bi-pencil" role="img">
</i> 
 <span class="menu-text">Design and Stimulii</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/study_info.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark" role="img">
</i> 
 <span class="menu-text">study 2 full info</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/initial_slides.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-slides-fill" role="img">
</i> 
 <span class="menu-text">MPA_Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/study1_info.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">study 1 codebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/study2_info.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">study 2 codebook</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#fit-ordinal-model-accuracy_level-refclass-1id-1state" id="toc-fit-ordinal-model-accuracy_level-refclass-1id-1state" class="nav-link active" data-scroll-target="#fit-ordinal-model-accuracy_level-refclass-1id-1state">Fit Ordinal model accuracy_level ~ refClass + (1|id) + (1|state)</a></li>
  <li><a href="#study-2" id="toc-study-2" class="nav-link" data-scroll-target="#study-2">Study 2</a></li>
  <li><a href="#no-interaction-model-used-in-mpa" id="toc-no-interaction-model-used-in-mpa" class="nav-link" data-scroll-target="#no-interaction-model-used-in-mpa">no interaction model used in MPA</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/Representation_Study/blob/main/mpa/mpa_analysis.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="mpa_hugo.md"><i class="bi bi-file-code"></i>CommonMark (hugo)</a></li><li><a href="mpa_gfm.md"><i class="bi bi-file-code"></i>Github (GFM)</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../nb/study1.html"><strong>Analysis</strong></a></li><li class="breadcrumb-item"><a href="../mpa/mpa_analysis.html">MPA</a></li></ol></nav><div class="quarto-title">
<h1 class="title">MPA abstract analysis</h1>
</div>



<div class="quarto-title-meta column-body">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">here</span>,<span class="va">tibble</span>,<span class="va">brms</span>,<span class="va">rstan</span>,<span class="va">bayestestR</span>,<span class="va">emmeans</span>,<span class="va">tidybayes</span>,<span class="va">modelsummary</span>,</span>
<span>               <span class="va">ggplot2</span>,<span class="va">gt</span>,<span class="va">knitr</span>,<span class="va">kableExtra</span>,<span class="va">ggh4x</span>,<span class="va">lme4</span>,<span class="va">flextable</span>,<span class="va">pander</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span>, scipen<span class="op">=</span><span class="fl">999</span>, dplyr.summarise.inform<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">walk</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fun_plot"</span><span class="op">)</span>, <span class="op">~</span> <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"scripts/"</span>, <span class="va">.x</span>, <span class="st">".R"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_nice</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>brms.backend<span class="op">=</span><span class="st">"cmdstanr"</span>,mc.cores<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/s1_processed.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/s1_discrep_ids.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s2_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/s2_processed.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/s2_discrep_ids.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fit-ordinal-model-accuracy_level-refclass-1id-1state" class="level2"><h2 class="anchored" data-anchor-id="fit-ordinal-model-accuracy_level-refclass-1id-1state">Fit Ordinal model accuracy_level ~ refClass + (1|id) + (1|state)</h2>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ordinal_model_s1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>    <span class="va">accuracy_level</span> <span class="op">~</span> <span class="va">refClass</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">s1_agg</span>,</span>
<span>    family <span class="op">=</span> <span class="fu">cumulative</span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>, </span>
<span>    prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>, </span>
<span>                <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/model_cache"</span>,<span class="st">'s1_ordinal3.rds'</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ordinal_model_s1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = logit; disc = identity 
Formula: accuracy_level ~ refClass + (1 | id) + (1 | state) 
   Data: s1_agg (Number of observations: 940) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~id (Number of levels: 235) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     3.69      0.28     3.17     4.29 1.00     1280     2107

~state (Number of levels: 4) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.73      0.48     0.24     2.04 1.00     1561     2190

Regression Coefficients:
                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]          -1.85      0.56    -2.92    -0.75 1.00     1144     2042
Intercept[2]           0.22      0.55    -0.82     1.34 1.00     1185     2062
Intercept[3]           2.86      0.56     1.83     4.00 1.00     1271     2210
refClassPercentage     0.65      0.59    -0.48     1.82 1.00      764     1403
refClassUSD            2.48      0.56     1.41     3.64 1.00      818     1626

Further Distributional Parameters:
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">ordinal_model_s1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="mpa_analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_posterior</span><span class="op">(</span><span class="va">ordinal_model_s1</span>, centrality <span class="op">=</span> <span class="st">"Mode"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">Parameter</span>, <span class="st">"b_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Parameter <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">Parameter</span>, <span class="st">"b_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">kable</span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Mode</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">pd</th>
<th style="text-align: right;">ROPE_CI</th>
<th style="text-align: right;">ROPE_low</th>
<th style="text-align: right;">ROPE_high</th>
<th style="text-align: right;">ROPE_Percentage</th>
<th style="text-align: right;">Rhat</th>
<th style="text-align: right;">ESS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept[1]</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-2.92</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1121</td>
</tr>
<tr class="even">
<td style="text-align: left;">Intercept[2]</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.82</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intercept[3]</td>
<td style="text-align: right;">3.52</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1232</td>
</tr>
<tr class="even">
<td style="text-align: left;">refClassPercentage</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">1.82</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">742</td>
</tr>
<tr class="odd">
<td style="text-align: left;">refClassUSD</td>
<td style="text-align: right;">2.88</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">3.64</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">799</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get predicted probabilities</span></span>
<span><span class="va">pred_summary</span> <span class="op">&lt;-</span> <span class="va">ordinal_model_s1</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">epred_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>refClass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kWh"</span>, <span class="st">"Percentage"</span>, <span class="st">"USD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                ndraws <span class="op">=</span> <span class="fl">1000</span>, re_formula <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>, <span class="va">.category</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>        mean_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span>,</span>
<span>        lower_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.epred</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>        upper_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.epred</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">pred_summary</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Study 1: Predicted probabilities of accuracy"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
---------------------------------------------------------------
  refClass      .category      mean_prob   lower_ci   upper_ci 
------------ ---------------- ----------- ---------- ----------
 Percentage    Exact match      0.08624    0.02506     0.2217  

 Percentage   0.01-2% error     0.3147      0.1435     0.4715  

 Percentage   2.01-15% error    0.4874      0.2841     0.6046  

 Percentage   Over 15% error    0.1117     0.02927     0.2581  

    USD        Exact match      0.0151     0.004301   0.04121  

    USD       0.01-2% error     0.0895     0.03159     0.2028  

    USD       2.01-15% error    0.4809      0.2973     0.6016  

    USD       Over 15% error    0.4145      0.1781     0.6601  

    kWh        Exact match      0.1478     0.04952     0.3218  

    kWh       0.01-2% error     0.4048      0.2597     0.5129  

    kWh       2.01-15% error    0.3866      0.1879     0.5558  

    kWh       Over 15% error    0.0608     0.01967     0.1345  
---------------------------------------------------------------

Table: Study 1: Predicted probabilities of accuracy</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Convert log-odds to odds ratios</span></span>
<span><span class="va">posterior_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ordinal_model_s1</span><span class="op">)</span></span>
<span><span class="va">odds_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Percentage_vs_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior_samples</span><span class="op">$</span><span class="va">b_refClassPercentage</span><span class="op">)</span>,</span>
<span>  USD_vs_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior_samples</span><span class="op">$</span><span class="va">b_refClassUSD</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate summary statistics</span></span>
<span><span class="va">odds_ratio_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    comparison <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Percentage vs kWh"</span>, <span class="st">"USD vs kWh"</span><span class="op">)</span>,</span>
<span>    odds_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">Percentage_vs_kWh</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">USD_vs_kWh</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">Percentage_vs_kWh</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">USD_vs_kWh</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">Percentage_vs_kWh</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">$</span><span class="va">USD_vs_kWh</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">odds_ratio_summary</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">comparison</th>
<th style="text-align: right;">odds_ratio</th>
<th style="text-align: right;">ci_lower</th>
<th style="text-align: right;">ci_upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Percentage vs kWh</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">USD vs kWh</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">38.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># |comparison        | odds_ratio| ci_lower| ci_upper|</span></span>
<span><span class="co"># |:-----------------|----------:|--------:|--------:|</span></span>
<span><span class="co"># |Percentage vs kWh |        2.3|     0.62|      6.2|</span></span>
<span><span class="co"># |USD vs kWh        |       14.1|     4.08|     38.0|</span></span>
<span></span>
<span></span>
<span><span class="va">odds_ratio_summary</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Study 1: Odds ratios of accuracy"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
------------------------------------------------------
    comparison       odds_ratio   ci_lower   ci_upper 
------------------- ------------ ---------- ----------
 Percentage vs kWh     2.274       0.6178     6.148   

    USD vs kWh         14.09        4.08      38.04   
------------------------------------------------------

Table: Study 1: Odds ratios of accuracy</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot predicted probabilities</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">pred_summary</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">refClass</span>, y <span class="op">=</span> <span class="va">mean_prob</span>, fill <span class="op">=</span> <span class="va">.category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_ci</span>, ymax <span class="op">=</span> <span class="va">upper_ci</span><span class="op">)</span>,</span>
<span>                    position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Predicted Probability"</span>, x <span class="op">=</span> <span class="st">"Reference Class"</span>, fill <span class="op">=</span> <span class="st">"Accuracy Level"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Study 1: Predicted Probabilities of Accuracy Level by Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-2-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="mpa_analysis_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">comparison</th>
<th style="text-align: right;">odds_ratio</th>
<th style="text-align: right;">ci_lower</th>
<th style="text-align: right;">ci_upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Percentage vs kWh</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">USD vs kWh</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">38.0</td>
</tr>
</tbody>
</table></section><section id="study-2" class="level1"><h1>Study 2</h1>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s2_agg1</span> <span class="op">&lt;-</span> <span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span> <span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">state</span>,<span class="va">refClass</span>,<span class="va">pct</span>,<span class="va">pct_goal</span>,<span class="va">plan</span>,<span class="va">rounded</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    orig_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span>,</span>
<span>    pct_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">orig_kWh</span> <span class="op">-</span> <span class="va">total_kWh</span><span class="op">)</span> <span class="op">/</span> <span class="va">orig_kWh</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    state_dif <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">state_dif</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>matched_goal <span class="op">=</span> <span class="op">(</span><span class="va">pct_change</span> <span class="op">==</span> <span class="va">pct</span><span class="op">)</span>,</span>
<span>                error <span class="op">=</span> <span class="va">pct_change</span> <span class="op">-</span> <span class="va">pct</span>,</span>
<span>                abs_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add ungroup here</span></span>
<span>        <span class="fu">mutate</span><span class="op">(</span></span>
<span>            accuracy_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>                <span class="fu">case_when</span><span class="op">(</span></span>
<span>                    <span class="va">abs_error</span> <span class="op">==</span> <span class="fl">0.00</span> <span class="op">~</span> <span class="st">"Exact match"</span>,</span>
<span>                    <span class="va">abs_error</span> <span class="op">&lt;=</span> <span class="fl">0.02</span> <span class="op">~</span> <span class="st">"0.01-2% error"</span>,</span>
<span>                    <span class="va">abs_error</span> <span class="op">&lt;=</span> <span class="fl">0.15</span> <span class="op">~</span> <span class="st">"2.01-15% error"</span>,</span>
<span>                    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Over 15% error"</span>  <span class="co"># Capture all remaining cases</span></span>
<span>                <span class="op">)</span>, </span>
<span>                levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exact match"</span>, <span class="st">"0.01-2% error"</span>, <span class="st">"2.01-15% error"</span>, <span class="st">"Over 15% error"</span><span class="op">)</span>,</span>
<span>                ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">s2_agg1</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">accuracy_level</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Accuracy Levels by Reference Class"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Percentage of Participants"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="mpa_analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">observed_props2</span> <span class="op">&lt;-</span> <span class="va">s2_agg1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>, <span class="va">accuracy_level</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">accuracy_level</span>,</span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">prop</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Calculate proportions</span></span>
<span><span class="va">prop_acc_s2</span> <span class="op">&lt;-</span> <span class="va">s2_agg1</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>, <span class="va">accuracy_level</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Probability <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">prop_acc_s2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">accuracy_level</span>, y <span class="op">=</span> <span class="va">Probability</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Accuracy Levels by Reference Class"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-3-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="mpa_analysis_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">s2_agg1</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">accuracy_level</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Accuracy Levels by Reference Class"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Percentage of Participants"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">rounded</span><span class="op">+</span><span class="va">pct_goal</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-3-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="mpa_analysis_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop4_acc_s2</span> <span class="op">&lt;-</span> <span class="va">s2_agg1</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>, <span class="va">accuracy_level</span>,<span class="va">rounded</span>,<span class="va">pct_goal</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Probability <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span></span>
<span></span>
<span><span class="va">s2_agg1</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span> <span class="va">accuracy_level</span>,<span class="va">rounded</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">rounded</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>Probability <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 Ã— 4
  accuracy_level rounded     count Probability
  &lt;ord&gt;          &lt;chr&gt;       &lt;int&gt;       &lt;dbl&gt;
1 Exact match    Not Rounded   104      0.265 
2 Exact match    Rounded       133      0.339 
3 0.01-2% error  Not Rounded    47      0.120 
4 0.01-2% error  Rounded        34      0.0867
5 2.01-15% error Not Rounded   121      0.309 
6 2.01-15% error Rounded       118      0.301 
7 Over 15% error Not Rounded   120      0.306 
8 Over 15% error Rounded       107      0.273 </code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">prop4_acc_s2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">accuracy_level</span>, y <span class="op">=</span> <span class="va">Probability</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Accuracy Levels by Reference Class"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">rounded</span><span class="op">+</span><span class="va">pct_goal</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-3-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="mpa_analysis_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">prop4_acc_s2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">accuracy_level</span>, y <span class="op">=</span> <span class="va">Probability</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Accuracy Levels by Reference Class"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-3-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="mpa_analysis_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="no-interaction-model-used-in-mpa" class="level1"><h1>no interaction model used in MPA</h1>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s2_agg1</span> <span class="op">&lt;-</span> <span class="va">s2_agg1</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    refClass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">refClass</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kWh"</span>, <span class="st">"Percentage"</span>, <span class="st">"USD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    rounded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">rounded</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Not Rounded"</span>, <span class="st">"Rounded"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    pct_goal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">pct_goal</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"10%"</span>, <span class="st">"15%"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">ordinal_model_s2_probit</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">accuracy_level</span> <span class="op">~</span> <span class="va">refClass</span> <span class="op">+</span><span class="va">rounded</span><span class="op">+</span><span class="va">pct_goal</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span><span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">s2_agg1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">cumulative</span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>, <span class="co"># Recommended for ordinal models</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,  <span class="co"># Priors for thresholds</span></span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Priors for predictors</span></span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/model_cache"</span>,<span class="st">'s2_op.rds'</span><span class="op">)</span><span class="op">)</span> <span class="co"># Cache for efficiency</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ordinal_model_s2_probit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: cumulative 
  Links: mu = probit; disc = identity 
Formula: accuracy_level ~ refClass + rounded + pct_goal + (1 | id) + (1 | state) 
   Data: s2_agg1 (Number of observations: 784) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~id (Number of levels: 196) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     2.58      0.22     2.18     3.03 1.01      539     1502

~state (Number of levels: 4) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.28      0.28     0.02     1.06 1.01      877     1127

Regression Coefficients:
                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]          -1.12      0.38    -1.88    -0.37 1.01      686     1070
Intercept[2]          -0.28      0.38    -1.04     0.47 1.01      693     1085
Intercept[3]           1.81      0.38     1.04     2.56 1.01      702     1248
refClassPercentage     0.58      0.45    -0.32     1.49 1.01      446      741
refClassUSD            1.19      0.47     0.29     2.11 1.01      583     1087
roundedRounded        -0.37      0.10    -0.57    -0.17 1.00     5613     2928
pct_goal15%           -0.26      0.10    -0.46    -0.06 1.00     5136     2842

Further Distributional Parameters:
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
disc     1.00      0.00     1.00     1.00   NA       NA       NA

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Regression Coefficients:</span></span>
<span><span class="co">#                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co"># Intercept[1]          -1.12      0.38    -1.88    -0.37 1.01      686     1070</span></span>
<span><span class="co"># Intercept[2]          -0.28      0.38    -1.04     0.47 1.01      693     1085</span></span>
<span><span class="co"># Intercept[3]           1.81      0.38     1.04     2.56 1.01      702     1248</span></span>
<span><span class="co"># refClassPercentage     0.58      0.45    -0.32     1.49 1.01      446      741</span></span>
<span><span class="co"># refClassUSD            1.19      0.47     0.29     2.11 1.01      583     1087</span></span>
<span><span class="co"># roundedRounded        -0.37      0.10    -0.57    -0.17 1.00     5613     2928</span></span>
<span><span class="co"># pct_goal15%           -0.26      0.10    -0.46    -0.06 1.00     5136     2842</span></span>
<span></span>
<span><span class="va">pred_summary_s2</span> <span class="op">&lt;-</span> <span class="va">ordinal_model_s2_probit</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epred_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">s2_agg1</span>, re_formula <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>, <span class="va">rounded</span>, <span class="va">pct_goal</span>, <span class="va">.category</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span>,</span>
<span>    lower_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.epred</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    upper_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.epred</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">pred_summary_s2</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Study 1: Predicted probabilities of accuracy level by reference class"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
------------------------------------------------------------------------------
  refClass      rounded     pct_goal     .category      mean_prob   lower_ci  
------------ ------------- ---------- ---------------- ----------- -----------
    kWh       Not Rounded     10%       Exact match      0.1472      0.03015  

    kWh       Not Rounded     10%      0.01-2% error     0.2488      0.1166   

    kWh       Not Rounded     10%      2.01-15% error    0.5584      0.3113   

    kWh       Not Rounded     10%      Over 15% error    0.04553    0.005226  

    kWh       Not Rounded     15%       Exact match      0.2098      0.0519   

    kWh       Not Rounded     15%      0.01-2% error     0.2817      0.1627   

    kWh       Not Rounded     15%      2.01-15% error    0.4818       0.23    

    kWh       Not Rounded     15%      Over 15% error    0.02668    0.002531  

    kWh         Rounded       10%       Exact match      0.2402      0.06674  

    kWh         Rounded       10%      0.01-2% error     0.2918      0.1812   

    kWh         Rounded       10%      2.01-15% error    0.4469      0.1954   

    kWh         Rounded       10%      Over 15% error    0.02105    0.001662  

    kWh         Rounded       15%       Exact match      0.3216      0.1056   

    kWh         Rounded       15%      0.01-2% error      0.305      0.2139   

    kWh         Rounded       15%      2.01-15% error    0.3619      0.1353   

    kWh         Rounded       15%      Over 15% error    0.01149    0.0007068 

 Percentage   Not Rounded     10%       Exact match      0.05624    0.006472  

 Percentage   Not Rounded     10%      0.01-2% error     0.1537      0.04267  

 Percentage   Not Rounded     10%      2.01-15% error    0.6626      0.4985   

 Percentage   Not Rounded     10%      Over 15% error    0.1275      0.02203  

 Percentage   Not Rounded     15%       Exact match      0.08897     0.01365  

 Percentage   Not Rounded     15%      0.01-2% error     0.1968      0.07105  

 Percentage   Not Rounded     15%      2.01-15% error    0.6303      0.4219   

 Percentage   Not Rounded     15%      Over 15% error    0.08395     0.01235  

 Percentage     Rounded       10%       Exact match      0.1062      0.01689  

 Percentage     Rounded       10%      0.01-2% error     0.2148      0.08276  

 Percentage     Rounded       10%      2.01-15% error    0.6096       0.381   

 Percentage     Rounded       10%      Over 15% error    0.06943    0.008626  

 Percentage     Rounded       15%       Exact match      0.1572      0.03291  

 Percentage     Rounded       15%      0.01-2% error     0.2544      0.1193   

 Percentage     Rounded       15%      2.01-15% error    0.5457      0.2929   

 Percentage     Rounded       15%      Over 15% error    0.04273    0.004174  

    USD       Not Rounded     10%       Exact match      0.01654    0.0008973 

    USD       Not Rounded     10%      0.01-2% error     0.06991     0.01107  

    USD       Not Rounded     10%      2.01-15% error    0.6277      0.4217   

    USD       Not Rounded     10%      Over 15% error    0.2859      0.07566  

    USD       Not Rounded     15%       Exact match      0.0291     0.002112  

    USD       Not Rounded     15%      0.01-2% error     0.1013      0.02037  

    USD       Not Rounded     15%      2.01-15% error    0.6594      0.4985   

    USD       Not Rounded     15%      Over 15% error    0.2103      0.04502  

    USD         Rounded       10%       Exact match      0.03619    0.003047  

    USD         Rounded       10%      0.01-2% error     0.1165      0.02681  

    USD         Rounded       10%      2.01-15% error    0.6649      0.5111   

    USD         Rounded       10%      Over 15% error    0.1824      0.03351  

    USD         Rounded       15%       Exact match      0.05954     0.00658  

    USD         Rounded       15%      0.01-2% error     0.1564      0.04406  

    USD         Rounded       15%      2.01-15% error    0.6581      0.4846   

    USD         Rounded       15%      Over 15% error     0.126      0.01841  
------------------------------------------------------------------------------

Table: Study 1: Predicted probabilities of accuracy level by reference class (continued below)

 
----------
 upper_ci 
----------
  0.3559  

  0.3539  

  0.7192  

  0.1491  

  0.4462  

  0.369   

  0.6909  

 0.09281  

  0.4975  

  0.3721  

  0.6714  

 0.07903  

  0.5866  

  0.3772  

  0.6052  

 0.04704  

  0.1734  

  0.2928  

  0.7472  

  0.3233  

  0.2484  

  0.3258  

  0.7401  

  0.2368  

  0.2834  

  0.3372  

  0.7359  

  0.2074  

  0.3708  

  0.358   

  0.7169  

  0.1407  

 0.06815  

  0.1911  

  0.7406  

  0.5628  

  0.1099  

  0.2363  

  0.7476  

  0.4625  

  0.1346  

  0.2582  

  0.7482  

  0.419   

  0.1955  

  0.2983  

  0.7473  

  0.3265  
----------</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract posterior samples</span></span>
<span><span class="va">posterior_samples_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ordinal_model_s2_probit</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">odds_ratios_s2</span> <span class="op">&lt;-</span> <span class="va">posterior_samples_s2</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">transmute</span><span class="op">(</span></span>
<span>        refClass_Percentage_vs_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b_refClassPercentage</span><span class="op">)</span>,</span>
<span>        refClass_USD_vs_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b_refClassUSD</span><span class="op">)</span>,</span>
<span>        rounded_Yes_vs_No <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b_roundedRounded</span><span class="op">)</span>,</span>
<span>        pct_goal_15_vs_10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">`b_pct_goal15%`</span><span class="op">)</span>  <span class="co"># Note the backticks here</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculate summary statistics</span></span>
<span><span class="va">odds_ratio_summary_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    comparison <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Percentage vs kWh"</span>, <span class="st">"USD vs kWh"</span>, <span class="st">"Rounded vs Not"</span>, <span class="st">"15% Goal vs 10% Goal"</span><span class="op">)</span>,</span>
<span>    odds_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_Percentage_vs_kWh</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_USD_vs_kWh</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">rounded_Yes_vs_No</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">pct_goal_15_vs_10</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_Percentage_vs_kWh</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_USD_vs_kWh</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">rounded_Yes_vs_No</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">pct_goal_15_vs_10</span>, <span class="fl">0.025</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_Percentage_vs_kWh</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">refClass_USD_vs_kWh</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">rounded_Yes_vs_No</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">odds_ratios_s2</span><span class="op">$</span><span class="va">pct_goal_15_vs_10</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#             comparison odds_ratio ci_lower ci_upper</span></span>
<span><span class="co"># 1    Percentage vs kWh       1.99     0.73     4.43</span></span>
<span><span class="co"># 2           USD vs kWh       3.69     1.33     8.29</span></span>
<span><span class="co"># 3       Rounded vs Not       0.70     0.57     0.84</span></span>
<span><span class="co"># 4 15% Goal vs 10% Goal       0.78     0.63     0.94</span></span>
<span></span>
<span><span class="va">odds_ratio_summary_s2</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">comparison</th>
<th style="text-align: right;">odds_ratio</th>
<th style="text-align: right;">ci_lower</th>
<th style="text-align: right;">ci_upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Percentage vs kWh</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">4.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">USD vs kWh</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">8.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rounded vs Not</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">15% Goal vs 10% Goal</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.94</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">odds_ratio_summary_s2</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Study 2: Odds ratios of accuracy"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
---------------------------------------------------------
      comparison        odds_ratio   ci_lower   ci_upper 
---------------------- ------------ ---------- ----------
  Percentage vs kWh       1.989       0.7262     4.425   

      USD vs kWh          3.691       1.334      8.288   

    Rounded vs Not        0.6959      0.5656     0.8446  

 15% Goal vs 10% Goal     0.7757      0.6301     0.9396  
---------------------------------------------------------

Table: Study 2: Odds ratios of accuracy</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">pred_summary</span>, </span>
<span>        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.category</span>, y <span class="op">=</span> <span class="va">mean_prob</span>, fill <span class="op">=</span> <span class="va">refClass</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_ci</span>, ymax <span class="op">=</span> <span class="va">upper_ci</span><span class="op">)</span>, </span>
<span>                    position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Reference Class"</span>, </span>
<span>        y <span class="op">=</span> <span class="st">"Predicted Probability"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"Accuracy Level"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Predicted Probabilities of Accuracy Levels by Reference Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlBu"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="mpa_analysis_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="mpa_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">comparison</th>
<th style="text-align: right;">odds_ratio</th>
<th style="text-align: right;">ci_lower</th>
<th style="text-align: right;">ci_upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Percentage vs kWh</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">4.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">USD vs kWh</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">8.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rounded vs Not</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">15% Goal vs 10% Goal</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.94</td>
</tr>
</tbody>
</table>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tegorman13\.github\.io\/Representation_Study\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../misc/ordinal.html" class="pagination-link" aria-label="Ordinal Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Ordinal Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../background/study_stim.html" class="pagination-link" aria-label="Design and Stimulii">
        <span class="nav-page-text">Design and Stimulii</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2024 <a href="https://tegorman13.github.io">Thomas Gorman</a></p>
</div>   
    <div class="nav-footer-center">
<p>site made with <a href="https://cran.r-project.org/"><i class="fa-brands fa-r-project" aria-label="r-project"></i></a> and <a href="https://quarto.org/">Quarto</a></p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tegorman13/Representation_Study/blob/main/mpa/mpa_analysis.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/tegorman13/Representation_Study" target="_blank">
<p><i class="fa-brands fa-github fa-2.0x" aria-label="github"></i></p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>