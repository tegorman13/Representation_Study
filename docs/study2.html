<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.18">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Thomas E. Gorman">
<title>Study 2 Analysis â€“ Representation Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./study_info.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-018089954d508eae8a473f0b7f0491f0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7113c57a5f829fad3d6a2692c6003666.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="site_libs/jszip-1.13.6/jszip.min.js"></script><script src="site_libs/pdfmake-1.13.6/pdfmake.js"></script><script src="site_libs/pdfmake-1.13.6/vfs_fonts.js"></script><link href="site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link rel="stylesheet" href="assets/style_qt.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./study2.html">Analysis</a></li><li class="breadcrumb-item"><a href="./study2.html">Study 2 Analysis</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Representation Study</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/tegorman13/Representation_Study" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Study 2 Analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Background</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study_info.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">study_info</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./initial_slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">initial_slides</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./study2.html">Analysis</a></li><li class="breadcrumb-item"><a href="./study2.html">Study 2 Analysis</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Study 2 Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author column-body">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://tegorman13.github.io/">Thomas E. Gorman</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://web.ics.purdue.edu/~treimer/">
            Communication and Cognition Lab, Purdue University, USA
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-body">

      
  
    
  </div>
  


</header><div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">here</span>, <span class="va">haven</span>,<span class="va">tibble</span>,<span class="va">ggplot2</span>,<span class="va">gt</span>,<span class="va">ggh4x</span>,<span class="va">lme4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span>, scipen<span class="op">=</span><span class="fl">999</span>, dplyr.summarise.inform<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">walk</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fun_plot"</span><span class="op">)</span>, <span class="op">~</span> <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Scripts/"</span>, <span class="va">.x</span>, <span class="st">".R"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_nice</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/read_spss.html">read_sav</a></span><span class="op">(</span><span class="st">"data/Frequency &amp; Probability Study 2 - 3-24-19.sav"</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">s2</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">EndDate</span>, <span class="st">"%H%M%S"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">relocate</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">s2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    state1 <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">COLORADO</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Colorado"</span>,</span>
<span>      <span class="va">MASSACHUSETTS</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Massachusetts"</span>,</span>
<span>      <span class="va">CALIFORNIA</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"California"</span>,</span>
<span>      <span class="va">TEXAS</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Texas"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span></span>
<span>    <span class="op">)</span>,</span>
<span>    state2 <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">COLORADO</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Colorado"</span>,</span>
<span>      <span class="va">MASSACHUSETTS</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Massachusetts"</span>,</span>
<span>      <span class="va">CALIFORNIA</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"California"</span>,</span>
<span>      <span class="va">TEXAS</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Texas"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>refClass <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>  <span class="va">REFERENCECLASS</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"USD"</span>,</span>
<span>  <span class="va">REFERENCECLASS</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"kWh"</span>,</span>
<span>  <span class="va">REFERENCECLASS</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"Percentage"</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">refClass</span>,<span class="va">state1</span>,<span class="va">state2</span>, .after <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">s2_b1</span> <span class="op">&lt;-</span> <span class="va">s2</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">state1</span>,<span class="va">refClass</span>,<span class="va">TENPERCENT</span>,<span class="va">ROUNDED</span>, <span class="va">ACFAMILY1</span><span class="op">:</span><span class="va">TOTALAPTWO1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> </span>
<span>    block <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    state<span class="op">=</span><span class="va">state1</span>,</span>
<span>  pct_goal<span class="op">=</span><span class="fu">case_when</span> <span class="op">(</span><span class="va">TENPERCENT</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"10%"</span>, <span class="va">TENPERCENT</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"15%"</span><span class="op">)</span>, </span>
<span>  rounded <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">ROUNDED</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Rounded"</span>, <span class="va">ROUNDED</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Not Rounded"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">relocate</span><span class="op">(</span><span class="va">id</span>,<span class="va">block</span>,<span class="va">refClass</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span>,<span class="va">state</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">TENPERCENT</span>,<span class="op">-</span><span class="va">ROUNDED</span>, <span class="op">-</span><span class="va">state1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s2_b2</span> <span class="op">&lt;-</span> <span class="va">s2</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">state2</span>,<span class="va">refClass</span>,<span class="va">TENPERCENT</span>,<span class="va">ROUNDED</span>, <span class="va">ACFAMILY2</span><span class="op">:</span><span class="va">TOTALAPTWO2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> </span>
<span>    block <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    state<span class="op">=</span><span class="va">state2</span>,</span>
<span>  pct_goal<span class="op">=</span><span class="fu">case_when</span> <span class="op">(</span><span class="va">TENPERCENT</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"15%"</span>, <span class="va">TENPERCENT</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"10%"</span><span class="op">)</span>, </span>
<span>  rounded <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">ROUNDED</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Not Rounded"</span>, <span class="va">ROUNDED</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Rounded"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">relocate</span><span class="op">(</span><span class="va">id</span>,<span class="va">block</span>,<span class="va">refClass</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span>,<span class="va">state</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">TENPERCENT</span>,<span class="op">-</span><span class="va">ROUNDED</span>, <span class="op">-</span><span class="va">state2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># pivot data into longer format, so that each appliance type is on its own row, so for each appliance we have the family value, state, value, plan 1 value, and plan 2 value</span></span>
<span><span class="co"># so for the first row for id 113029, we would have ACFAMILY1 ACSTATE1 ACAPONE1 ACAPTWO1, then the next row would be HEATFAMILY1 HEATSTATE1 HEATAPONE1 HEATAPTWO1, etc.</span></span>
<span><span class="co"># so each of the bill sources, AC, HEAT, WATER, REFRIG, OTHER, will now be on its own row, with the family, state, value, plan 1 value, and plan 2 value</span></span>
<span></span>
<span><span class="va">s2_b1_long</span> <span class="op">&lt;-</span> <span class="va">s2_b1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ACFAMILY1</span><span class="op">:</span><span class="va">TOTALAPTWO1</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"appliance"</span>, <span class="st">"measure"</span><span class="op">)</span>,</span>
<span>    names_pattern <span class="op">=</span> <span class="st">"(AC|HEAT|WATER|REFRIG|OTHER|TOTAL)(FAMILY1|STATE1|APONE1|APTWO1)"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">measure</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    family <span class="op">=</span> <span class="va">FAMILY1</span>,</span>
<span>    state_avg <span class="op">=</span> <span class="va">STATE1</span>,</span>
<span>    plan1 <span class="op">=</span> <span class="va">APONE1</span>,</span>
<span>    plan2 <span class="op">=</span> <span class="va">APTWO1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">appliance</span>, .after <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">s2_b2_long</span> <span class="op">&lt;-</span> <span class="va">s2_b2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ACFAMILY2</span><span class="op">:</span><span class="va">TOTALAPTWO2</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"appliance"</span>, <span class="st">"measure"</span><span class="op">)</span>,</span>
<span>    names_pattern <span class="op">=</span> <span class="st">"(AC|HEAT|WATER|REFRIG|OTHER|TOTAL)(FAMILY2|STATE2|APONE2|APTWO2)"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">measure</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    family <span class="op">=</span> <span class="va">FAMILY2</span>,</span>
<span>    state_avg <span class="op">=</span> <span class="va">STATE2</span>,</span>
<span>    plan1 <span class="op">=</span> <span class="va">APONE2</span>,</span>
<span>    plan2 <span class="op">=</span> <span class="va">APTWO2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">appliance</span>, .after <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">s2_long</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">s2_b1_long</span>, <span class="va">s2_b2_long</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">id</span>, <span class="va">block</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># pivot so that plan1 and plan2 are on their own rows</span></span>
<span><span class="va">s2_long</span> <span class="op">&lt;-</span> <span class="va">s2_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">block</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">plan1</span>, <span class="va">plan2</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"plan"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>change <span class="op">=</span> <span class="va">value</span><span class="op">-</span><span class="va">family</span>, state_dif <span class="op">=</span> <span class="va">value</span><span class="op">-</span><span class="va">state_avg</span>,plan<span class="op">=</span><span class="fu">as_factor</span><span class="op">(</span><span class="va">plan</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co">#write.csv(s2_long,"data/study_2_tg.csv")</span></span>
<span></span>
<span><span class="co"># compute total kWh reduction, and total % reduction </span></span>
<span><span class="va">sum1</span> <span class="op">&lt;-</span> <span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span><span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">refClass</span>,<span class="va">state</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span>,<span class="va">block</span>,<span class="va">plan</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,orig_kWh<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span>, pct_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">orig_kWh</span><span class="op">-</span><span class="va">total_kWh</span><span class="op">)</span><span class="op">/</span><span class="va">orig_kWh</span>,<span class="fl">3</span><span class="op">)</span>, state_dif<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">state_dif</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="inspect-response-distribution-for-outliers" class="level2"><h2 class="anchored" data-anchor-id="inspect-response-distribution-for-outliers">Inspect response distribution for outliers</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">sum1</span> <span class="op">|&gt;</span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>change_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pct_change</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,change_sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">pct_change</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                     z_score<span class="op">=</span><span class="op">(</span><span class="va">pct_change</span><span class="op">-</span><span class="va">change_mean</span><span class="op">)</span><span class="op">/</span><span class="va">change_sd</span>,</span>
<span>                                     is_outlier<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_score</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">2.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outlier_id</span> <span class="op">&lt;-</span> <span class="va">outliers</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">is_outlier</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outlier_summary</span> <span class="op">&lt;-</span> <span class="va">outliers</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">pct_goal</span>, <span class="va">rounded</span>, <span class="va">refClass</span>,<span class="va">state</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    num_outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_outlier</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    total <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    outlier_percentage <span class="op">=</span> <span class="op">(</span><span class="va">num_outliers</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">outlier_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">outliers</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, y <span class="op">=</span> <span class="va">z_score</span>, color <span class="op">=</span> <span class="va">is_outlier</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">pct_goal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Z-Scores of Change in Energy Usage by State - outliers colored"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"State"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Z-Score"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Outlier"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assess skewness and normality of the data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="co"># Calculate skewness and kurtosis for the `pct_change` variable</span></span>
<span><span class="va">skewness_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">sum1</span><span class="op">$</span><span class="va">pct_change</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">kurtosis_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">sum1</span><span class="op">$</span><span class="va">pct_change</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Skewness:"</span>, <span class="va">skewness_value</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Skewness: 1.2 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Kurtosis:"</span>, <span class="va">kurtosis_value</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Kurtosis: 3 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Shapiro-Wilk test for normality (sample size limitation)</span></span>
<span><span class="va">shapiro_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">sum1</span><span class="op">$</span><span class="va">pct_change</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Using first 5000 observations if large dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">shapiro_test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  sum1$pct_change[1:5000]
W = 0.8, p-value &lt;0.0000000000000002</code></pre>
</div>
</div>
</section><div class="page-columns page-full">
<section id="before-and-after-excluding-outliers" class="level2"><h2 class="anchored" data-anchor-id="before-and-after-excluding-outliers">Before and after excluding outliers</h2>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#outlier_plot</span></span>
<span></span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pct_change</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">state</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rug</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">refClass</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Distribution of Percent Change by State and Reference Class - Before outlier exclusion"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Percent Change"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set2"</span><span class="op">)</span></span>
<span><span class="co"># plot densities in a better way to account for the positive skew</span></span>
<span></span>
<span><span class="va">sum1</span> <span class="op">&lt;-</span> <span class="va">sum1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">outlier_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">outlier_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pct_change</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">state</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rug</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_boxplot</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">refClass</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"After outlier exclusion"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Percent Change"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="study2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="864"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-3-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="study2_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="864"></a></p>
</div>
</div>
</div>
</section><section id="individual-participant-responses" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="individual-participant-responses">Individual Participant responses</h2>
<ul>
<li>Facets indicate the Reference class (%, kWh, USD) and the goal % reduction (10%, 15%)</li>
<li>dashed lines also indicate goal percentage - dots on the line indicate participants who met the goal</li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># add geom_vline with x intercept based on pct_goal of the data (which is currently a string of form 10%)</span></span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">block</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>goal_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">pct_goal</span>,<span class="st">"%"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">pct_change</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>,x<span class="op">=</span><span class="va">pct_change</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span>,alpha<span class="op">=</span><span class="fl">0.6</span>,position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>w<span class="op">=</span><span class="fl">0</span>, h<span class="op">=</span><span class="fl">0.17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">goal_pct</span><span class="op">)</span>,linetype<span class="op">=</span><span class="st">"dashed"</span>,alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">refClass</span><span class="op">~</span><span class="va">pct_goal</span>,axes<span class="op">=</span><span class="st">"all"</span>,scales<span class="op">=</span><span class="st">"free"</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Participant Id"</span>, x<span class="op">=</span><span class="st">"Percent Change"</span>, title<span class="op">=</span><span class="st">"Individual Performance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope Light"</span>, face <span class="op">=</span> <span class="st">"plain"</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>,<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full"><p class="page-columns page-full"><a href="study2_files/figure-html/unnamed-chunk-4-1.png" class="lightbox page-columns page-full" data-gallery="quarto-lightbox-gallery-3"><img src="study2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img column-page-right" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="interactive-data-table" class="level2"><h2 class="anchored" data-anchor-id="interactive-data-table">Interactive data table</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot distribution of reductions by applicance</span></span>
<span><span class="co"># s2_long |&gt; ggplot(aes(x = change)) + geom_histogram(bins = 30) + facet_wrap(~appliance, scales = "free")</span></span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>refClass<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">refClass</span><span class="op">)</span>,pct_goal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">pct_goal</span><span class="op">)</span>,rounded<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">rounded</span><span class="op">)</span>,state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span>extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    dom <span class="op">=</span> <span class="st">'Blfrtip'</span>,</span>
<span>    buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span>,</span>
<span>    pageLength <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    autoWidth <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  filter <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span> <span class="co"># Add filtering at the top of each column)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-64fbcea87cf2aa1aabda" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-64fbcea87cf2aa1aabda">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"74040\" data-max=\"223715\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;USD&quot;,&quot;Percentage&quot;,&quot;kWh&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Massachusetts&quot;,&quot;Texas&quot;,&quot;Colorado&quot;,&quot;California&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;15%&quot;,&quot;10%&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Rounded&quot;,&quot;Not Rounded&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;plan1&quot;,&quot;plan2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"6220\" data-max=\"51000\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"19516\" data-max=\"46293\" data-scale=\"11\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-0.354\" data-max=\"0.786\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-4450.4\" data-max=\"4093\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752"],[74040,74040,74040,74040,74312,74312,74312,74312,74440,74440,74440,74440,74709,74709,74709,74709,74729,74729,74729,74729,74827,74827,74827,74827,74940,74940,74940,74940,75022,75022,75022,75022,75029,75029,75029,75029,75037,75037,75037,75037,75038,75038,75038,75038,75234,75234,75234,75234,75305,75305,75305,75305,75549,75549,75549,75549,75616,75616,75616,75616,75633,75633,75633,75633,75646,75646,75646,75646,75819,75819,75819,75819,75929,75929,75929,75929,80151,80151,80151,80151,80208,80208,80208,80208,80210,80210,80210,80210,80424,80424,80424,80424,80447,80447,80447,80447,80532,80532,80532,80532,80536,80536,80536,80536,80635,80635,80635,80635,80701,80701,80701,80701,80909,80909,80909,80909,81659,81659,81659,81659,81915,81915,81915,81915,82044,82044,82044,82044,82424,82424,82424,82424,83053,83053,83053,83053,83110,83110,83110,83110,83747,83747,83747,83747,83926,83926,83926,83926,84104,84104,84104,84104,84400,84400,84400,84400,84629,84629,84629,84629,84914,84914,84914,84914,85429,85429,85429,85429,91308,91308,91308,91308,91424,91424,91424,91424,91443,91443,91443,91443,91449,91449,91449,91449,91510,91510,91510,91510,91821,91821,91821,91821,92032,92032,92032,92032,92712,92712,92712,92712,93009,93009,93009,93009,93840,93840,93840,93840,93951,93951,93951,93951,94026,94026,94026,94026,94642,94642,94642,94642,101457,101457,101457,101457,102246,102246,102246,102246,102356,102356,102356,102356,102402,102402,102402,102402,102644,102644,102644,102644,102746,102746,102746,102746,102846,102846,102846,102846,102940,102940,102940,102940,103110,103110,103110,103110,103120,103120,103120,103120,103132,103132,103132,103132,103443,103443,103443,103443,103616,103616,103616,103616,103712,103712,103712,103712,103955,103955,103955,103955,104405,104405,104405,104405,104415,104415,104415,104415,104614,104614,104614,104614,104630,104630,104630,104630,104733,104733,104733,104733,105331,105331,105331,105331,105808,105808,105808,105808,110923,110923,110923,110923,110943,110943,110943,110943,111702,111702,111702,111702,112242,112242,112242,112242,112917,112917,112917,112917,113011,113011,113011,113011,113020,113020,113020,113020,113029,113029,113029,113029,113521,113521,113521,113521,114222,114222,114222,114222,114435,114435,114435,114435,114649,114649,114649,114649,115300,115300,115300,115300,115535,115535,115535,115535,115928,115928,115928,115928,120258,120258,120258,120258,120707,120707,120707,120707,120933,120933,120933,120933,121726,121726,121726,121726,122858,122858,122858,122858,123220,123220,123220,123220,123825,123825,123825,123825,124450,124450,124450,124450,125803,125803,125803,125803,130522,130522,130522,130522,130601,130601,130601,130601,163448,163448,163448,163448,163838,163838,163838,163838,164000,164000,164000,164000,164003,164003,164003,164003,164237,164237,164237,164237,164644,164644,164644,164644,165531,165531,165531,165531,165833,165833,165833,165833,171812,171812,171812,171812,171846,171846,171846,171846,171856,171856,171856,171856,172037,172037,172037,172037,172549,172549,172549,172549,173505,173505,173505,173505,174947,174947,174947,174947,181349,181349,181349,181349,184138,184138,184138,184138,191615,191615,191615,191615,195603,195603,195603,195603,195846,195846,195846,195846,200049,200049,200049,200049,200150,200150,200150,200150,200202,200202,200202,200202,200235,200235,200235,200235,200456,200456,200456,200456,200515,200515,200515,200515,200602,200602,200602,200602,200629,200629,200629,200629,200729,200729,200729,200729,200750,200750,200750,200750,200815,200815,200815,200815,200833,200833,200833,200833,200843,200843,200843,200843,200856,200856,200856,200856,200911,200911,200911,200911,200913,200913,200913,200913,200921,200921,200921,200921,201014,201014,201014,201014,201113,201113,201113,201113,201300,201300,201300,201300,201528,201528,201528,201528,201546,201546,201546,201546,201551,201551,201551,201551,201623,201623,201623,201623,201630,201630,201630,201630,201647,201647,201647,201647,201655,201655,201655,201655,201707,201707,201707,201707,202009,202009,202009,202009,202009,202009,202009,202009,202119,202119,202119,202119,202218,202218,202218,202218,202228,202228,202228,202228,202504,202504,202504,202504,202520,202520,202520,202520,202552,202552,202552,202552,202653,202653,202653,202653,202737,202737,202737,202737,202758,202758,202758,202758,202916,202916,202916,202916,203100,203100,203100,203100,203104,203104,203104,203104,203234,203234,203234,203234,203309,203309,203309,203309,203542,203542,203542,203542,203635,203635,203635,203635,203810,203810,203810,203810,203822,203822,203822,203822,203829,203829,203829,203829,203910,203910,203910,203910,204012,204012,204012,204012,204056,204056,204056,204056,204201,204201,204201,204201,204745,204745,204745,204745,204751,204751,204751,204751,205019,205019,205019,205019,205352,205352,205352,205352,205438,205438,205438,205438,205813,205813,205813,205813,210131,210131,210131,210131,211120,211120,211120,211120,212036,212036,212036,212036,213526,213526,213526,213526,214040,214040,214040,214040,223715,223715,223715,223715],["USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","kWh","kWh","kWh","kWh","USD","USD","USD","USD","USD","USD","USD","USD","kWh","kWh","kWh","kWh","Percentage","Percentage","Percentage","Percentage","USD","USD","USD","USD"],["Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Massachusetts","Massachusetts","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Colorado","Colorado","California","California","Colorado","Colorado","California","California","Colorado","Colorado","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas","California","California","Massachusetts","Massachusetts","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","California","California","Colorado","Colorado","Massachusetts","Massachusetts","Texas","Texas","Colorado","Colorado","Texas","Texas"],["15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","15%","15%","10%","10%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%","10%","10%","15%","15%","10%","10%","15%","15%","15%","15%","10%","10%","10%","10%","15%","15%"],["Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded","Not Rounded","Not Rounded","Rounded","Rounded","Rounded","Rounded","Not Rounded","Not Rounded"],[2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,2,2,1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,1,1,2,2,2,2,1,1,2,2,1,1,2,2,1,1,1,1,2,2,1,1,2,2],["plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2","plan1","plan2"],[46001,50001,27000,27000,33803,33803,26100,26100,17000,17000,28300,28300,19550,19550,35791,35791,20700,20700,33803,33803,34700,40000,24650,25650,18200,20000,39000,36000,19200,19200,30000,30000,26300,26000,19500,19300,41400,41400,25689,24113,33500,30100,18000,18000,41200,41200,24692,24692,18000,13100,41300,21750,19000,23400,18000,25000,40000,40000,24689,24689,46002,32135,29000,22950,21803,24098,15635,17362,19200,19200,34000,34000,35200,36200,24500,23500,31400,27400,20200,16500,39349,39349,26100,26100,30450,28750,28500,26900,34000,34000,25827,27188,20100,20300,40950,41100,31001,29301,22000,21000,44530,37340,29000,22330,37300,38650,25500,24650,20325,19250,41400,41400,18543,17626,43347,29506,21850,16700,30000,28300,27700,26700,17700,17700,20700,20700,39349,39349,39200,39200,25700,26100,19300,19500,41000,35950,20000,19170,32868,28843,14050.5,19545,41666,18565.124,20610,9955,12801,6220,41400,41400,24689,24689,34402,24376,18750,13010,20403,20000,34000,29000,31700,33400,22965,22900,20700,13300,39349,39349,16000,17000,26000,27000,20200,16700,37730,28900,31900,32100,22400,22500,18500,15000,34520,30400,40025,32154,28463,21529,36000,36000,24707,24516,37900,27550,29000,23500,46293,32207,29000,22945,20700,20700,30535,30535,39560,39560,22466,22466,19550,18800,32207,41664,25048,19587,19638,15169,12600,10600,20200,15944,20700,20700,33803,33803,20200,20200,34100,34100,13000,11500,20000,20000,19000,16000,47450,35400,19273,19273,41400,41400,39100,39100,26141,26141,17700,16750,30300,28500,19273,19273,36000,36000,22200,20200,40000,30390,31350,29100,20000,16800,19547,19547,35785,35785,20700,20700,39346,39346,19500,19500,34800,35000,34000,34000,26141,26141,20405,20405,39100,39100,19550,19550,35791,35791,19550,19550,35791,35791,35700,35700,24650,24650,34600,36700,24700,25600,27607,25000,18588,14231,18800,18500,25400,25200,19388,25235,21337,24288,19273,19273,41400,41400,19272,19272,34000,34000,21100,15400,14000,10500,18900,19300,31822,32650,18000,18000,41001,39001,20000,9800,40900,29200,11400,7982,26554,22366,34000,34000,26100,26100,36400,25300,23000,19000,39000,51000,23000,28000,31700,35850,22300,22600,32900,33120,28000,27100,36100,33100,24000,24000,22000,22864,34200,27150,19100,19100,30500,30500,41664,41666,24650,24650,19600,19400,33800,31900,20000,19100,39930,37650,20000,15260,14445,10730,15500,17000,30300,34300,28500,28000,21500,19500,31300,32550,25300,26000,11500,11225,19300,15805,46400,32300,31000,22000,36000,36000,24691,24691,19547,19547,41667,41667,29200,27800,18600,15300,19550,19550,41664,41664,32300,33300,23000,28000,39349,39349,26100,26100,20500,30700,28250,25900,40349,39349,26100,26500,36000,36000,24689,24689,46293,32207,29000,22945,20500,19500,39000,34400,20700,20700,33803,33803,19550,19550,35791,35791,35791,35791,24650,24650,18000,15300,28100,30500,41500,36000,20800,24500,20700,20700,39346,39346,39001,39001,26000,26000,11500,9375,19351,14974,19600,19600,41400,41400,12400,7200,16500,9300,33803,34203,26100,26100,20407,15907,39100,39100,33500,31650,25500,24300,41664,41664,24650,24450,22050,20900,36300,32550,34000,34000,26141,26141,19270,19200,34000,34000,19272,19072,36000,36000,34300,28050,21000,16880,33800,33800,26100,26100,42001,37496,25500,24000,35500,35560,24689,24626,19458,19458,36000,34000,24150,18000,17700,17100,36000,36000,24689,24689,20406,20412,34000,34000,16400,18600,34649,38649,21200,19400,35700,31200,19269,19272,41400,41400,19200,20300,34030,38080,20700,21000,33803,33000,18250,17000,29575,22660,25600,29200,19000,21000,19272,19272,36000,36000,20400,20401,34000,34000,19272,19272,36000,36000,23400,23400,18216,18216,32650,31000,23000,25000,40200,40200,24650,24650,20700,20700,33802,33802,39100,39100,26141,26141,20063,19608,39010,39010,41662,28984,24650,19504,19272,19200,34000,34000,38900,39900,26000,26000,36000,36000,25000,25000,42501,33001,22000,22800,22482,22482,39330,39330,19269,19269,41400,41400,20400,20400,41410,50410,34003,33803,26100,26100,41400,41400,24689,24689,30500,15300,24045,19407,22333,22333,39340,39340,17500,null,39000,36150,20700,20700,33700,33700,30000,14700,24000,23000,19000,19000,32000,35000,20000,20000,34000,34000,19272,19272,40400,41400,19500,18800,33020,34920,39259,37430,24000,22500,20100,20100,39101,39101,41664,41564,24650,24650,14000,12350,25300,22200,12793,32207,6601,8003,30000,36000,24782,24532,39100,38900,26141,26141,39100,39100,26141,26141,32300,30600,22800,22400,18500,18800,39100,33150,22450,19289,38050,31337,34525,37350,21400,23100,20700,20700,34306,33803,45893,31211,28340,23034,30600,30400,24600,24400],[46000,46000,29046,29046,39768,39768,29000,29000,23000,23000,39768,39768,23000,23000,39768,39768,23000,23000,39768,39768,46293,46293,29000,29000,22673,22673,46000,46000,22673,22673,40000,40000,39768,39768,29000,29000,46000,46000,29046,29046,40000,40000,29046,29046,46000,46000,29046,29046,22673,22673,40000,40000,19516,19516,46000,46000,46000,46000,29046,29046,46000,46000,29046,29046,22673,22673,40000,40000,22673,22673,40000,40000,40000,40000,29046,29046,39768,39768,29000,29000,46293,46293,29000,29000,39768,39768,29000,29000,40000,40000,23794.257,23794.257,23000,23000,46293,46293,46001,46001,29046,29046,46293,46293,29000,29000,39768,39768,29000,29000,22673,22673,46000,46000,23000,23000,46293,46293,22673,22673,40000,40000,40000,40000,29046,29046,23000,23000,46293,46293,46000,46000,29046,29046,23000,23000,46293,46293,23000,23000,39768,39768,23000,23000,46293,46293,46000,46000,29046,29046,46000,46000,29046,29046,46000,46000,29046,29046,22673,22673,40000,40000,46293,46293,29000,29000,23000,23000,46293,46293,22673,22673,46000,46000,23000,23000,39768,39768,46293,46293,29000,29000,22673,22673,46000,46000,46000,46000,29046,29046,40000,40000,29046,29046,39768,39768,29000,29000,46293,46293,29000,29000,23000,23000,39768,39768,40000,40000,29046,29046,23000,23000,46293,46293,39768,39768,29000,29000,46293,46293,29000,29000,23000,23000,39768,39768,22673,22673,46000,46000,22673,22673,40000,40000,23000,23000,39768,39768,22673,22673,46000,46000,46000,46000,29046,29046,22673,22673,40000,40000,22673,22673,40000,40000,22673,22673,40000,40000,46293,46293,29000,29000,23000,23000,39768,39768,23000,23000,46293,46293,23000,23000,39768,39768,40000,40000,29046,29046,22673,22673,46000,46000,23000,23000,39768,39768,23000,23000,39768,39768,39768,39768,29000,29000,46000,46000,29046,29046,46000,46000,29046,29046,22673,22673,40000,40000,46293,46293,29000,29000,22673,22673,46000,46000,22673,22673,40000,40000,40000,40000,29046,29046,23000,23000,46293,46293,22673,22673,46000,46000,22673,22673,46000,46000,22673,22673,40000,40000,40000,40000,23794.257,23794.257,46293,46293,29000,29000,40000,40000,29046,29046,46293,46293,29000,29000,46293,46293,29000,29000,46000,46000,29046,29046,23000,23000,39768,39768,22673,22673,40000,40000,46293,46293,29000,29000,22673,22673,40000,40000,23000,23000,46293,46293,40000,40000,29046,29046,23000,23000,46293,46293,40000,40000,29046,29046,39768,39768,29000,29000,23000,23000,39768,39768,46293,46293,29000,29000,40000,40000,29046,29046,23000,23000,46293,46293,39768,39768,29000,29000,23000,23000,46293,46293,46000,46000,29046,29046,46293,46293,29000,29000,22673,22673,46000,46000,46293,46293,29000,29000,40000,40000,29046,29046,46293,46293,29000,29000,23000,23000,46293,46293,23000,23000,39768,39768,23000,23000,39768,39768,39768,39768,29000,29000,23000,23000,39768,39768,46293,46293,29000,29000,23000,23000,46293,46293,46000,46000,29046,29046,23000,23000,39768,39768,22673,22673,46000,46000,22673,22673,40000,40000,39768,39768,29000,29000,22673,22673,46000,46000,40000,40000,22933,22933,46293,46293,29000,29000,22673,22673,40000,40000,40000,40000,23794.257,23794.257,22673,22673,40000,40000,22673,22673,40000,40000,40000,40000,29046,29046,39768,39768,29000,29000,46000,46000,29046,29046,40000,40000,29046,29046,22673,22673,40000,40000,46000,46000,29046,29046,40000,40000,29046,29046,22673,22673,40000,40000,23000,23000,46293,46293,22673,22673,40000,40000,22673,22673,46000,46000,23000,23000,46293,46293,23000,23000,39768,39768,23000,23000,39768,39768,39768,39768,29000,29000,22673,22673,40000,40000,22673,22673,40000,40000,22673,22673,40000,40000,40000,40000,23794.257,23794.257,40000,40000,29046,29046,46293,46293,29000,29000,23000,23000,39768,39768,46000,46000,29046,29046,22673,22673,46000,46000,46293,46293,29000,29000,22673,22673,40000,40000,46293,46293,29000,29000,40000,40000,29046,29046,46000,46000,29046,29046,23000,23000,39768,39768,22673,22673,46000,46000,22673,22673,46000,46000,39768,39768,29000,29000,46000,46000,29046,29046,40000,40000,29046,29046,22673,22673,40000,40000,22673,22673,40000,40000,23000,23000,39768,39768,40000,40000,29046,29046,22673,22673,46000,46000,22673,22673,40000,40000,22673,22673,46000,46000,23000,23000,39768,39768,46293,46293,29000,29000,22673,22673,46001,46001,46293,46293,29000,29000,39768,39768,29000,29000,46000,46000,29046,29046,40000,40000,29046,29046,46000,46000,29046,29046,46000,46000,29046,29046,39768,39768,29000,29000,23000,23000,46293,46293,22673,22673,40000,40000,46293,46293,29000,29000,23000,23000,39768,39768,46293,46293,29000,29000,40000,40000,29046,29046],[-0,-0.08699999999999999,0.07000000000000001,0.07000000000000001,0.15,0.15,0.1,0.1,0.261,0.261,0.288,0.288,0.15,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.25,0.136,0.15,0.116,0.197,0.118,0.152,0.217,0.153,0.153,0.25,0.25,0.339,0.346,0.328,0.334,0.1,0.1,0.116,0.17,0.162,0.248,0.38,0.38,0.104,0.104,0.15,0.15,0.206,0.422,-0.032,0.456,0.026,-0.199,0.609,0.457,0.13,0.13,0.15,0.15,-0,0.301,0.002,0.21,0.038,-0.063,0.609,0.5659999999999999,0.153,0.153,0.15,0.15,0.12,0.095,0.157,0.191,0.21,0.311,0.303,0.431,0.15,0.15,0.1,0.1,0.234,0.277,0.017,0.07199999999999999,0.15,0.15,-0.08500000000000001,-0.143,0.126,0.117,0.115,0.112,0.326,0.363,0.243,0.277,0.038,0.193,0,0.23,0.062,0.028,0.121,0.15,0.104,0.151,0.1,0.1,0.194,0.234,0.064,0.363,0.036,0.263,0.25,0.292,0.308,0.332,0.391,0.391,0.1,0.1,0.15,0.15,0.148,0.148,0.115,0.101,0.161,0.152,0.114,0.223,0.13,0.167,0.174,0.275,0.389,0.15,0.1,0.599,0.552,0.784,0.5590000000000001,0.786,0.1,0.1,0.15,0.15,0.252,0.47,0.354,0.552,0.1,0.118,0.15,0.275,0.315,0.279,0.208,0.21,0.1,0.422,0.15,0.15,0.294,0.25,0.435,0.413,0.122,0.274,0.051,0.273,0.311,0.307,0.228,0.224,0.184,0.338,0.25,0.339,0.13,0.301,0.02,0.259,0.1,0.1,0.149,0.156,0.047,0.307,0,0.19,0,0.304,0,0.209,0.1,0.1,0.232,0.232,0.011,0.011,0.227,0.227,0.15,0.183,0.304,0.1,0.37,0.507,0.323,0.477,0.728,0.771,0.303,0.45,0.1,0.1,0.15,0.15,0.109,0.109,0.259,0.259,0.427,0.493,0.5,0.5,0.174,0.304,-0.193,0.11,0.15,0.15,0.1,0.1,0.15,0.15,0.1,0.1,0.219,0.261,0.242,0.288,0.15,0.15,0.1,0.1,0.021,0.109,0,0.24,0.323,0.371,0.31,0.421,0.15,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.152,0.152,0.125,0.12,0.15,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15,0.1,0.1,0.15,0.15,0.1,0.1,0.102,0.102,0.15,0.15,0.248,0.202,0.15,0.119,0.4,0.457,0.36,0.51,0.171,0.184,0.365,0.37,0.581,0.455,0.264,0.162,0.15,0.15,0.1,0.1,0.15,0.15,0.15,0.15,0.472,0.615,0.518,0.639,0.178,0.161,0.313,0.295,0.206,0.206,0.109,0.152,0.118,0.5679999999999999,0.111,0.365,0.497,0.648,0.336,0.441,0.15,0.15,-0.097,-0.097,0.214,0.453,0.207,0.345,0.025,-0.275,0.208,0.036,0.315,0.226,0.231,0.221,0.289,0.285,0.034,0.066,0.215,0.28,0.174,0.174,0.043,0.006,0.14,0.317,0.158,0.158,0.238,0.238,0.1,0.1,0.15,0.15,0.136,0.144,0.155,0.202,0.13,0.17,0.137,0.187,0.5,0.619,0.503,0.631,0.326,0.261,0.345,0.259,0.288,0.3,0.26,0.329,0.213,0.182,0.128,0.103,0.5,0.512,0.515,0.603,-0.002,0.302,-0.06900000000000001,0.241,0.1,0.1,0.15,0.15,0.15,0.15,0.1,0.1,0.266,0.301,0.359,0.472,0.15,0.15,0.1,0.1,0.298,0.276,0.208,0.036,0.15,0.15,0.1,0.1,0.096,-0.354,0.386,0.437,0.128,0.15,0.1,0.08599999999999999,0.1,0.1,0.15,0.15,0,0.304,0,0.209,0.109,0.152,0.158,0.257,0.1,0.1,0.15,0.15,0.15,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.217,0.335,0.293,0.233,0.104,0.222,0.283,0.155,0.1,0.1,0.15,0.15,0.152,0.152,0.105,0.105,0.5,0.592,0.513,0.623,0.136,0.136,0.1,0.1,0.453,0.6820000000000001,0.588,0.767,0.15,0.14,0.1,0.1,0.1,0.298,0.15,0.15,0.162,0.209,-0.112,-0.06,0.1,0.1,0.15,0.157,0.027,0.078,0.092,0.186,0.15,0.15,-0.099,-0.099,0.15,0.153,0.15,0.15,0.15,0.159,0.1,0.1,0.142,0.299,0.277,0.419,0.15,0.15,0.1,0.1,0.08699999999999999,0.185,0.122,0.174,0.112,0.111,0.15,0.152,0.142,0.142,0.1,0.15,0.475,0.609,0.391,0.411,0.1,0.1,0.15,0.15,0.1,0.1,0.15,0.15,0.287,0.191,0.252,0.165,0.065,0.144,0.108,0.22,0.15,0.15,0.1,0.1,0.165,0.117,0.265,0.177,0.1,0.08699999999999999,0.15,0.17,0.207,0.261,0.256,0.43,0.356,0.266,0.345,0.276,0.15,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15,0.1,0.1,0.415,0.415,0.234,0.234,0.184,0.225,0.208,0.139,0.132,0.132,0.15,0.15,0.1,0.1,0.15,0.15,0.15,0.15,0.1,0.1,0.115,0.135,0.152,0.152,0.1,0.374,0.15,0.327,0.15,0.153,0.15,0.15,0.16,0.138,0.103,0.103,0.1,0.1,0.139,0.139,0.076,0.283,0.243,0.215,0.023,0.023,0.011,0.011,0.15,0.15,0.1,0.1,0.1,0.1,0.1,-0.096,0.145,0.15,0.1,0.1,0.1,0.1,0.15,0.15,0.238,0.618,0.172,0.332,0.015,0.015,0.016,0.016,0.228,null,0.025,0.096,0.1,0.1,0.153,0.153,0.25,0.632,0.174,0.208,0.162,0.162,0.304,0.239,0.118,0.118,0.15,0.15,0.15,0.15,0.122,0.1,0.152,0.183,0.17,0.122,0.152,0.191,0.172,0.224,0.113,0.113,0.15,0.15,0.1,0.102,0.15,0.15,0.648,0.6889999999999999,0.128,0.234,0.722,0.3,0.773,0.724,0.25,0.1,0.147,0.155,0.15,0.154,0.1,0.1,0.15,0.15,0.1,0.1,0.188,0.231,0.214,0.228,0.196,0.183,0.155,0.284,0.01,0.149,0.049,0.217,0.254,0.193,0.262,0.203,0.1,0.1,0.137,0.15,0.008999999999999999,0.326,0.023,0.206,0.235,0.24,0.153,0.16],[2758.8,3558.8,811,811,653.6,653.6,631,631,-491.6,-491.6,-447,-447,18.40000000000002,18.39999999999995,1051.2,1051.2,248.4,248.4,653.6,653.6,498.5999999999997,1558.6,341,541,-251.6,108.4,1358.6,758.6,-51.60000000000002,-51.60000000000002,-107,-107,-847,-907,-689,-729,1838.6,1838.6,548.8,233.6,593,-87,-989,-989,1798.6,1798.6,349.4,349.4,-291.6,-1271.6,2153,-1757,-91.60000000000004,788.3999999999999,-2841.400000000001,-1441.4,1558.6,1558.6,348.8,348.8,2759,-14.4,1211,1,469,928,-2980,-2634.599999999999,-51.59999999999998,-51.60000000000002,693,693,933,1133,311,111,173,-627,-549,-1289,1428.4,1428.4,631,631,-17,-357,1111,791,693,693,576.4,848.6,128.4,168.4,1748.6,1778.6,-241.2,-581.2,-189,-389,2464.6,1026.6,1211,-123,1353,1623,511,341,173.4,-41.6,1838.6,1838.6,-183,-366.3999999999999,2228,-540.2,478.4,-551.6,-107,-447,-567,-767,-1049,-1049,248.4,248.4,1428.4,1428.4,1398.6,1398.6,551,631,-31.59999999999998,8.399999999999995,1758.6,748.6,108.4,-57.59999999999999,466.6,-338.4,-1081.5,17.39999999999999,1891.8,-2728.3752,-2319.4,-4450.4,-2028.8,-3345,1838.6,1838.6,348.8,348.8000000000001,439,-1566.2,-839,-1987,189,108.4,693,-307,-101.4,238.6,4,-9,248.4,-1231.6,1428.4,1428.4,-691.6,-491.6,-1241.4,-1041.4,148.4,-551.6,1439,-327,-61.4,-21.4,-109,-89,-191.6,-891.6,462.6,-361.3999999999999,1563.6,-10.60000000000006,1103.6,-283.2,1093,1093,352.4,314.1999999999999,1473,-597,1211,111,2817.2,0,1211,0,248.4,248.4,0,0,1805,1805,-95.80000000000003,-95.80000000000003,18.4,-131.6,0,1891.4,-1097.4,-2189.6,-661.4,-1555.2,-3921.4,-4321.4,-549,-1400.2,248.4,248.4,653.6,653.6,148.4,148.3999999999999,378.6,378.6000000000001,-1291.6,-1591.6,-2107,-2107,-91.60000000000008,-691.6,3383,973,-37,-37,1838.6,1838.6,1378.6,1378.6,639.2,639.2,-351.6,-541.6,-47,-407,-37,-37,1093,1093,548.4,148.4,1893,-29,-171.3999999999999,-621.4,-589,-1229,17.8,17.79999999999999,1050,1050,248.4,248.4,1427.8,1427.8,8.399999999999995,8.4,853,893,693,693,639.2,639.2,189.4,189.4,1378.6,1378.6,18.40000000000001,18.40000000000002,1051.2,1051.2,18.4,18.39999999999999,1051.2,1051.2,1033,1033,341,341,478.6,898.6000000000001,351,531,-920,-1441.4,-871.3999999999999,-1742.8,-131.6,-191.6,-1027,-1067,-2563.8,-1394.4,-321.6000000000001,268.6000000000001,-37,-37,1838.6,1838.6,-37.2,-37.19999999999998,693,693,-1887,-3027,-1789,-2489,-111.6,-31.6,-77,88.60000000000008,-291.6,-291.6,1758.8,1358.8,108.4,-1931.6,1738.6,-601.4,-1611.6,-2295.2,-796.2000000000002,-1633.8,693,693,631,631,838.6,-1381.4,11,-789,1693,4093,11,1011,-101.4,728.6,-129,-69,138.6,182.6,1011,831,778.6000000000001,178.6,211,211,508.4,681.2,733,-677,-71.59999999999999,-71.59999999999999,-7,-7,1891.4,1891.8,341,341,28.40000000000001,-11.59999999999999,653,273,108.4,-71.59999999999999,1544.6,1088.6,-2107,-3055,-1700,-2443,-791.6,-491.6,-381.4,418.6,-407,-507,-289,-689,153,403,471,611,-1591.6,-1646.6,-2247,-2946,2838.6,18.6,1611,-189,1093,1093,349.1999999999999,349.1999999999999,17.8,17.80000000000002,1892,1892,-267,-547,-869,-1529,18.39999999999999,18.40000000000001,1891.4,1891.4,18.59999999999998,218.6000000000001,11,1011,1428.4,1428.4,631,631,208.4,2248.4,-791.4,-1261.4,1628.4,1428.4,631,711,1093,1093,348.8000000000001,348.8000000000001,2817.2,0,1211,0,208.4,8.400000000000006,1358.6,438.6000000000001,248.4,248.4,653.6,653.6,18.39999999999991,18.39999999999995,1051.2,1051.2,1051.2,1051.2,341,341,-291.6,-831.6,-487,-7,1858.6,758.6,-429,311,248.4,248.4,1427.8,1427.8,1358.8,1358.8,611,611,-1591.6,-2016.6,-2236.8,-3112.2,28.40000000000001,28.40000000000002,1838.6,1838.6,-1411.6,-2451.6,-2807,-4247,653.6,733.6,631,631,189.8000000000001,-710.2000000000002,1378.6,1378.6,593,223,511,271,1891.4,1891.4,341,301,518.4,288.4,1153,403,693,693,639.2,639.2,-37.59999999999998,-51.59999999999998,693,693,-37.20000000000002,-77.20000000000002,1093,1093,753,-497,-389,-1213,653,653,631,631,1958.8,1057.8,511,211,993,1005,348.8000000000001,336.2,0,0,1093,693,-1611.4,-2841.4,-1049,-1169,1093,1093,348.8,348.8000000000001,189.6,190.8,693,693,-611.6000000000001,-171.6000000000001,488.4,1288.4,348.4,-11.6,null,null,-37.80000000000001,-37.2,1838.6,1838.6,-51.60000000000004,168.4,364.6,1174.6,248.4,308.3999999999999,653.6,493,-241.6,-491.6,-192,-1575,-987,-267,-789,-389,-37.19999999999998,-37.19999999999999,1093,1093,188.4,188.6,693,693,-37.20000000000002,-37.20000000000001,1093,1093,-1427,-1427,-945.8,-945.8,423,93,11,411,1598.6,1598.6,341,341,248.4,248.4,653.4,653.4,1378.6,1378.6,639.2,639.2,121,30,1360.6,1360.6,1891,-644.6,341,-688.2,-37.2,-51.59999999999999,693,693,1338.6,1538.6,611,611,1093,1093,411,411,2058.8,158.8,-189,-29,604.8,604.8,1759,1759,-37.79999999999998,-37.80000000000001,1838.6,1838.6,188.4,188.4,1840.6,3640.6,693.6,653.6,631,631,1838.6,1838.6,348.8,348.8,-7,-3047,220,-707.6,575,575,1761,1761,-391.6,null,1693,1123,248.4,248.4,633,633,-107,-3167,211,11,-91.59999999999999,-91.59999999999999,-41.4,558.6,108.4,108.4,693,693,-37.2,-37.20000000000002,1638.6,1838.6,8.400000000000023,-131.6,497,877,1410.4,1044.6,211,-89,128.4,128.4,1378.8,1378.8,1891.4,1871.4,341,341,-3307,-3637,471,-149,-3882.8,0,-3268.8,-2988.4,-107,1093,367.4,317.3999999999999,1378.6,1338.6,639.2,639.2,1378.6,1378.6,639.2,639.2,353,13,-29,-109,-191.6,-131.6000000000001,1378.6,188.6,598.4,-33.8,1503,160.4,463.6,1028.6,-309,31,248.4,248.4,754.2,653.6,2737.2,-199.2,1079,17.8,13,-27,331,291]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>refClass<\/th>\n      <th>state<\/th>\n      <th>pct_goal<\/th>\n      <th>rounded<\/th>\n      <th>block<\/th>\n      <th>plan<\/th>\n      <th>total_kWh<\/th>\n      <th>orig_kWh<\/th>\n      <th>pct_change<\/th>\n      <th>state_dif<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Blfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":7,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[1,6,8,9,10,11]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"id","targets":1},{"name":"refClass","targets":2},{"name":"state","targets":3},{"name":"pct_goal","targets":4},{"name":"rounded","targets":5},{"name":"block","targets":6},{"name":"plan","targets":7},{"name":"total_kWh","targets":8},{"name":"orig_kWh","targets":9},{"name":"pct_change","targets":10},{"name":"state_dif","targets":11}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[7,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#DT::datatable(sum1 |&gt; group_by(id,block) |&gt; summarise(diff(total_kWh),diff(orig_kWh)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</div>
<section id="main-effects-and-interactions" class="level2"><h2 class="anchored" data-anchor-id="main-effects-and-interactions">Main Effects and Interactions</h2>
<p><strong>Click on plots to enlarge</strong></p>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">refClass</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Reference Class"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Reference Class"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Reference Class"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">pct_goal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Goal % Reduction"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Goal % Reduction"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Goal % Reduction"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rounded</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">rounded</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Rounding"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Rounding"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Rounding"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Goal % Reduction and Reference Class"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Goal % Reduction"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill<span class="op">=</span> <span class="st">"Reference Class"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">state</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Goal % Reduction and Reference Class - Separated by State"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Goal % Reduction"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill<span class="op">=</span> <span class="st">"Reference Class"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">pct_change</span>, fill <span class="op">=</span> <span class="va">rounded</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">rounded</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Goal % Reduction and Rounding"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Goal % Reduction"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Change"</span>,</span>
<span>    fill<span class="op">=</span> <span class="st">"Rounding"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="study2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="study2_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="study2_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="study2_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="study2_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid" width="672"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="study2_files/figure-html/unnamed-chunk-6-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="study2_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid" width="672"></a></p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span><span class="co">#          block=factor(block)) |&gt;</span></span>
<span><span class="co">#   group_by(refClass,block,pct_goal) |&gt;</span></span>
<span><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=block)) + </span></span>
<span><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span><span class="co">#   ggforce::facet_col(~pct_goal)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span><span class="co">#          block=factor(block)) |&gt;</span></span>
<span><span class="co">#   group_by(refClass,,pct_goal,state) |&gt;</span></span>
<span><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=pct_goal)) + </span></span>
<span><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span><span class="co">#   ggforce::facet_col(~state)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span><span class="co">#          block=factor(block)) |&gt;</span></span>
<span><span class="co">#   group_by(refClass,,pct_goal,state,goal_pct) |&gt;</span></span>
<span><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=state)) + </span></span>
<span><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span><span class="co">#   ggforce::facet_col(~pct_goal)</span></span>
<span></span>
<span></span>
<span></span>
<span>  <span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span> <span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">refClass</span>,<span class="va">appliance</span>,<span class="va">state</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_kWh_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">change</span><span class="op">)</span>,se_pct_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">change</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_kWh_change</span>,y<span class="op">=</span><span class="va">refClass</span>,col<span class="op">=</span><span class="va">appliance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_pointrange</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin<span class="op">=</span><span class="va">mean_kWh_change</span><span class="op">-</span><span class="va">se_pct_change</span>,xmax<span class="op">=</span><span class="va">mean_kWh_change</span><span class="op">+</span><span class="va">se_pct_change</span><span class="op">)</span>,position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggforce</span><span class="fu">::</span><span class="fu"><a href="https://ggforce.data-imaginist.com/reference/facet_row.html">facet_col</a></span><span class="op">(</span><span class="op">~</span><span class="va">state</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="study2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span> <span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">refClass</span>,y<span class="op">=</span><span class="va">change</span>,fill<span class="op">=</span><span class="va">state</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">appliance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-7-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="study2_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># mixed effects model testing effect of refClass, state, and pct_goal on pct_change</span></span>
<span><span class="co"># marginal effects plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">pct_change</span> <span class="op">~</span> <span class="va">refClass</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">plan</span><span class="op">|</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sum1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: pct_change ~ refClass + (1 + plan | id) + (1 | state)
   Data: sum1

REML criterion at convergence: -1017

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.915 -0.427 -0.050  0.369  4.043 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 id       (Intercept) 0.009894 0.0995       
          planplan2   0.000839 0.0290   1.00
 state    (Intercept) 0.000315 0.0177       
 Residual             0.009102 0.0954       
Number of obs: 751, groups:  id, 187; state, 4

Fixed effects:
                   Estimate Std. Error t value
(Intercept)          0.1952     0.0172   11.33
refClassPercentage  -0.0190     0.0206   -0.93
refClassUSD         -0.0166     0.0220   -0.75

Correlation of Fixed Effects:
            (Intr) rfClsP
rfClssPrcnt -0.616       
refClassUSD -0.575  0.481
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"refClass"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="study2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">pct_change</span> <span class="op">~</span> <span class="va">pct_goal</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sum1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: pct_change ~ pct_goal + (1 | id) + (1 | state)
   Data: sum1

REML criterion at convergence: -1019

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.193 -0.367 -0.101  0.265  3.763 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.012725 0.113   
 state    (Intercept) 0.000326 0.018   
 Residual             0.009208 0.096   
Number of obs: 751, groups:  id, 187; state, 4

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.18308    0.01319    13.9
pct_goal15%  0.02384    0.00702     3.4

Correlation of Fixed Effects:
            (Intr)
pct_goal15% -0.265</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pct_goal"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-8-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="study2_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">pct_change</span> <span class="op">~</span> <span class="va">pct_goal</span><span class="op">*</span><span class="va">rounded</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sum1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: pct_change ~ pct_goal * rounded + (1 | id) + (1 | state)
   Data: sum1

REML criterion at convergence: -1007

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.180 -0.366 -0.097  0.268  3.751 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.012748 0.1129  
 state    (Intercept) 0.000326 0.0181  
 Residual             0.009226 0.0961  
Number of obs: 751, groups:  id, 187; state, 4

Fixed effects:
                           Estimate Std. Error t value
(Intercept)                  0.1895     0.0161   11.74
pct_goal15%                  0.0113     0.0188    0.60
roundedRounded              -0.0130     0.0188   -0.69
pct_goal15%:roundedRounded   0.0251     0.0348    0.72

Correlation of Fixed Effects:
            (Intr) pc_15% rnddRn
pct_goal15% -0.575              
roundedRndd -0.575  0.858       
pct_gl15%:R  0.533 -0.927 -0.927</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pct_goal"</span>,<span class="st">"rounded"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-8-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="study2_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">pct_change</span> <span class="op">~</span> <span class="va">refClass</span><span class="op">*</span><span class="va">pct_goal</span><span class="op">*</span><span class="va">rounded</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">state</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sum1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"refClass"</span>,<span class="st">"pct_goal"</span>,<span class="st">"rounded"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-8-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="study2_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">pct_change</span> <span class="op">~</span> <span class="va">state</span><span class="op">*</span><span class="va">pct_goal</span><span class="op">*</span><span class="va">rounded</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sum1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: pct_change ~ state * pct_goal * rounded + (1 | id)
   Data: sum1

REML criterion at convergence: -958

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.016 -0.399 -0.048  0.332  3.763 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.01283  0.1133  
 Residual             0.00921  0.0959  
Number of obs: 751, groups:  id, 187

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                    0.17314    0.02162    8.01
stateColorado                                  0.03022    0.03296    0.92
stateMassachusetts                             0.04800    0.03191    1.50
stateTexas                                    -0.01181    0.02532   -0.47
pct_goal15%                                   -0.01715    0.03172   -0.54
roundedRounded                                -0.00137    0.03238   -0.04
stateColorado:pct_goal15%                      0.01673    0.04711    0.36
stateMassachusetts:pct_goal15%                 0.00544    0.04685    0.12
stateTexas:pct_goal15%                         0.07988    0.03579    2.23
stateColorado:roundedRounded                  -0.00453    0.04648   -0.10
stateMassachusetts:roundedRounded             -0.02567    0.04588   -0.56
stateTexas:roundedRounded                     -0.01791    0.03787   -0.47
pct_goal15%:roundedRounded                     0.04505    0.04624    0.97
stateColorado:pct_goal15%:roundedRounded      -0.01719    0.04518   -0.38
stateMassachusetts:pct_goal15%:roundedRounded  0.00181    0.04912    0.04
stateTexas:pct_goal15%:roundedRounded         -0.05211    0.05312   -0.98</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="st">"pct_goal"</span>,<span class="st">"rounded"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="study2_files/figure-html/unnamed-chunk-8-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="study2_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># m1 &lt;- lmer(pct_change ~ refClass*pct_goal*rounded*state  + (1|id), data = sum1)</span></span>
<span><span class="co"># ggpredict(m1, c("refClass","pct_goal","rounded","state")) |&gt; plot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span> <span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">refClass</span>,y<span class="op">=</span><span class="va">state_dif</span>,fill<span class="op">=</span><span class="va">state</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">appliance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s2_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span> <span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">state_dif</span>,y<span class="op">=</span><span class="va">value</span>,col<span class="op">=</span><span class="va">state</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">appliance</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">sum1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">state_dif</span>,y<span class="op">=</span><span class="va">pct_change</span>,col<span class="op">=</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># compute total kWh reduction, and total % reduction </span></span>
<span><span class="va">s2_long</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">refClass</span>,<span class="va">state</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span>,<span class="va">block</span>,<span class="va">plan</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span><span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,orig_kWh<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span>, total_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">total_pct</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">state</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">s2_long</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">refClass</span>,<span class="va">state</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span><span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span>, total_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_goal</span>, y <span class="op">=</span> <span class="va">total_pct</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="va">s2_long</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">refClass</span>,<span class="va">state</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span><span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span>, orig_kWh<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span>, total_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state1</span>, y <span class="op">=</span> <span class="va">total_pct</span>, fill <span class="op">=</span> <span class="va">refClass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">pct_goal</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">s2_long</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">refClass</span>,<span class="va">state</span>,<span class="va">pct_goal</span>,<span class="va">rounded</span>,<span class="va">plan</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">appliance</span> <span class="op">!=</span><span class="st">"TOTAL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total_kWh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span>, total_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reduction</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">refClass</span>, y <span class="op">=</span> <span class="va">total_pct</span>, fill <span class="op">=</span> <span class="va">pct_goal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">plan</span><span class="op">~</span><span class="va">rounded</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span><span class="co">#   mutate(id=reorder(id,pct_change)) |&gt; </span></span>
<span><span class="co">#   ggplot(aes(y=id,x=pct_change)) + </span></span>
<span><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span><span class="co">#   ggh4x::facet_nested_wrap(refClass~pct_goal,axes="all",scales="free",ncol=2) </span></span>
<span></span>
<span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span><span class="co">#   mutate(id=reorder(id,pct_change)) |&gt; </span></span>
<span><span class="co">#   ggplot(aes(y=id,x=pct_change,col=refClass)) + </span></span>
<span><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span><span class="co">#   ggh4x::facet_nested_wrap(block~pct_goal,axes="all",scales="free",ncol=2) </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># sum1 |&gt; </span></span>
<span><span class="co">#   ungroup() |&gt; </span></span>
<span><span class="co">#     mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span><span class="co">#   ggplot(aes(x=state,y=pct_change,col=state)) + </span></span>
<span><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span><span class="co">#     geom_hline(aes(yintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span><span class="co">#   ggdist::stat_halfeye()+</span></span>
<span><span class="co">#   ggh4x::facet_nested_wrap(block~pct_goal,axes="all",ncol=2) </span></span>
<span></span>
<span></span>
<span><span class="co"># s2_long &lt;- s2 |&gt;</span></span>
<span><span class="co">#   pivot_longer(</span></span>
<span><span class="co">#     cols = c(ACFAMILY1:TOTALAPTWO1),</span></span>
<span><span class="co">#     names_to = c(".value", "appliance"),</span></span>
<span><span class="co">#     names_pattern = "(.*)(FAMILY1|STATE1|APONE1|APTWO1)$",</span></span>
<span><span class="co">#     values_to = "value"</span></span>
<span><span class="co">#   )</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># s2 |&gt; pivot_longer(cols = contains("FAMILY"), names_to = "Family", values_to = "kWh") |&gt; relocate(Family,kWh) |&gt; </span></span>
<span><span class="co">#   pivot_longer(cols = contains("STATE1"), names_to = "State", values_to = "kWh") |&gt; relocate(State)</span></span>
<span></span>
<span></span>
<span><span class="co"># </span></span>
<span><span class="co"># s2 |&gt; </span></span>
<span><span class="co">#   pivot_longer(cols=ACFAMILY1:TOTALAPTWO1, names_to = "appliance", values_to = "family") |&gt; relocate(appliance,family)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tegorman13\.github\.io\/Representation_Study\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Home">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Home</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./study_info.html" class="pagination-link" aria-label="study_info">
        <span class="nav-page-text">study_info</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Study 2 Analysis"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">- name: Thomas E. Gorman</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://tegorman13.github.io/</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliations: </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name:  Communication and Cognition Lab, Purdue University, USA</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation-url: https://web.ics.purdue.edu/~treimer/</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> false</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">  #echo: false</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co">      sidebar-width: 220px</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 1200px</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co">      margin-width: 170px</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co">      gutter-width: 1.0rem</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyr,here, haven,tibble,ggplot2,gt,ggh4x,lme4)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">2</span>, <span class="at">scipen=</span><span class="dv">999</span>, <span class="at">dplyr.summarise.inform=</span><span class="cn">FALSE</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(<span class="fu">c</span>(<span class="st">"fun_plot"</span>), <span class="sc">~</span> <span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"Scripts/"</span>, .x, <span class="st">".R"</span>))))</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_nice</span>())</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/Frequency &amp; Probability Study 2 - 3-24-19.sav"</span>)</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> s2 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(EndDate, <span class="st">"%H%M%S"</span>))) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(id)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> s2 <span class="sc">|&gt;</span> </span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">state1 =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>      COLORADO <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Colorado"</span>,</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>      MASSACHUSETTS <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Massachusetts"</span>,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>      CALIFORNIA <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"California"</span>,</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>      TEXAS <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Texas"</span>,</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">state2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>      COLORADO <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Colorado"</span>,</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>      MASSACHUSETTS <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Massachusetts"</span>,</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>      CALIFORNIA <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"California"</span>,</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>      TEXAS <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Texas"</span>,</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">refClass =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>  REFERENCECLASS <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"USD"</span>,</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  REFERENCECLASS <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"kWh"</span>,</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>  REFERENCECLASS <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Percentage"</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">|&gt;</span> </span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(refClass,state1,state2, <span class="at">.after =</span> id)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>s2_b1 <span class="ot">&lt;-</span> s2 <span class="sc">|&gt;</span> <span class="fu">select</span>(id,state1,refClass,TENPERCENT,ROUNDED, ACFAMILY1<span class="sc">:</span>TOTALAPTWO1) <span class="sc">|&gt;</span> </span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> <span class="dv">1</span>,</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">state=</span>state1,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct_goal=</span><span class="fu">case_when</span> (TENPERCENT <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"10%"</span>, TENPERCENT <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"15%"</span>), </span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded =</span> <span class="fu">case_when</span>(ROUNDED <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Rounded"</span>, ROUNDED <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Not Rounded"</span>)</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(id,block,refClass,pct_goal,rounded,state)  <span class="sc">|&gt;</span> </span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>TENPERCENT,<span class="sc">-</span>ROUNDED, <span class="sc">-</span>state1)</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>s2_b2 <span class="ot">&lt;-</span> s2 <span class="sc">|&gt;</span> <span class="fu">select</span>(id,state2,refClass,TENPERCENT,ROUNDED, ACFAMILY2<span class="sc">:</span>TOTALAPTWO2) <span class="sc">|&gt;</span> </span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> <span class="dv">2</span>,</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">state=</span>state2,</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct_goal=</span><span class="fu">case_when</span> (TENPERCENT <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"15%"</span>, TENPERCENT <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"10%"</span>), </span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded =</span> <span class="fu">case_when</span>(ROUNDED <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Not Rounded"</span>, ROUNDED <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Rounded"</span>)</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(id,block,refClass,pct_goal,rounded,state) <span class="sc">|&gt;</span> </span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>TENPERCENT,<span class="sc">-</span>ROUNDED, <span class="sc">-</span>state2)</span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot data into longer format, so that each appliance type is on its own row, so for each appliance we have the family value, state, value, plan 1 value, and plan 2 value</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a><span class="co"># so for the first row for id 113029, we would have ACFAMILY1 ACSTATE1 ACAPONE1 ACAPTWO1, then the next row would be HEATFAMILY1 HEATSTATE1 HEATAPONE1 HEATAPTWO1, etc.</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a><span class="co"># so each of the bill sources, AC, HEAT, WATER, REFRIG, OTHER, will now be on its own row, with the family, state, value, plan 1 value, and plan 2 value</span></span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>s2_b1_long <span class="ot">&lt;-</span> s2_b1 <span class="sc">|&gt;</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(ACFAMILY1<span class="sc">:</span>TOTALAPTWO1),</span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"appliance"</span>, <span class="st">"measure"</span>),</span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">"(AC|HEAT|WATER|REFRIG|OTHER|TOTAL)(FAMILY1|STATE1|APONE1|APTWO1)"</span>,</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> measure,</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> FAMILY1,</span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_avg =</span> STATE1,</span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">plan1 =</span> APONE1,</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">plan2 =</span> APTWO1</span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(appliance, <span class="at">.after =</span> refClass)</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>s2_b2_long <span class="ot">&lt;-</span> s2_b2 <span class="sc">|&gt;</span></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(ACFAMILY2<span class="sc">:</span>TOTALAPTWO2),</span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"appliance"</span>, <span class="st">"measure"</span>),</span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">"(AC|HEAT|WATER|REFRIG|OTHER|TOTAL)(FAMILY2|STATE2|APONE2|APTWO2)"</span>,</span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> measure,</span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> FAMILY2,</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_avg =</span> STATE2,</span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">plan1 =</span> APONE2,</span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">plan2 =</span> APTWO2</span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(appliance, <span class="at">.after =</span> refClass)</span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a>s2_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(s2_b1_long, s2_b2_long) <span class="sc">|&gt;</span> </span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, block) </span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot so that plan1 and plan2 are on their own rows</span></span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a>s2_long <span class="ot">&lt;-</span> s2_long <span class="sc">|&gt;</span></span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,block) <span class="sc">|&gt;</span> </span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(plan1, plan2),</span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"plan"</span>,</span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">change =</span> value<span class="sc">-</span>family, <span class="at">state_dif =</span> value<span class="sc">-</span>state_avg,<span class="at">plan=</span><span class="fu">as_factor</span>(plan)) </span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(s2_long,"data/study_2_tg.csv")</span></span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a><span class="co"># compute total kWh reduction, and total % reduction </span></span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> s2_long <span class="sc">|&gt;</span> </span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span><span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,refClass,state,pct_goal,rounded,block,plan) <span class="sc">|&gt;</span> </span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_kWh =</span> <span class="fu">sum</span>(value),<span class="at">orig_kWh=</span><span class="fu">sum</span>(family), <span class="at">pct_change =</span> <span class="fu">round</span>((orig_kWh<span class="sc">-</span>total_kWh)<span class="sc">/</span>orig_kWh,<span class="dv">3</span>), <span class="at">state_dif=</span><span class="fu">mean</span>(state_dif))</span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspect response distribution for outliers</span></span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> sum1 <span class="sc">|&gt;</span>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">change_mean=</span><span class="fu">mean</span>(pct_change,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">change_sd=</span><span class="fu">sd</span>(pct_change,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">z_score=</span>(pct_change<span class="sc">-</span>change_mean)<span class="sc">/</span>change_sd,</span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">is_outlier=</span><span class="fu">abs</span>(z_score)<span class="sc">&gt;</span><span class="fl">2.5</span>)</span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a>outlier_id <span class="ot">&lt;-</span> outliers <span class="sc">|&gt;</span> <span class="fu">filter</span>(is_outlier) <span class="sc">|&gt;</span> <span class="fu">pull</span>(id) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="ot">&lt;-</span> outliers <span class="sc">%&gt;%</span></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pct_goal, rounded, refClass,state) <span class="sc">%&gt;%</span></span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_outliers =</span> <span class="fu">sum</span>(is_outlier, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_percentage =</span> (num_outliers <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a>outlier_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(outliers, <span class="fu">aes</span>(<span class="at">x =</span> state, <span class="at">y =</span> z_score, <span class="at">color =</span> is_outlier)) <span class="sc">+</span></span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> pct_goal) <span class="sc">+</span></span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Z-Scores of Change in Energy Usage by State - outliers colored"</span>,</span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"State"</span>,</span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Z-Score"</span>,</span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Outlier"</span></span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess skewness and normality of the data</span></span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate skewness and kurtosis for the `pct_change` variable</span></span>
<span id="cb30-190"><a href="#cb30-190" aria-hidden="true" tabindex="-1"></a>skewness_value <span class="ot">&lt;-</span> <span class="fu">skewness</span>(sum1<span class="sc">$</span>pct_change, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-191"><a href="#cb30-191" aria-hidden="true" tabindex="-1"></a>kurtosis_value <span class="ot">&lt;-</span> <span class="fu">kurtosis</span>(sum1<span class="sc">$</span>pct_change, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Skewness:"</span>, skewness_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kurtosis:"</span>, kurtosis_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality (sample size limitation)</span></span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(sum1<span class="sc">$</span>pct_change[<span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>])  <span class="co"># Using first 5000 observations if large dataset</span></span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_test)</span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a>::: column-page-right</span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Before and after excluding outliers</span></span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 9</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 6</span></span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a><span class="co">#outlier_plot</span></span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>pct_change)) <span class="sc">+</span></span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill=</span>state), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>refClass) <span class="sc">+</span></span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution of Percent Change by State and Reference Class - Before outlier exclusion"</span>,</span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Percent Change"</span>,</span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Set2"</span>)</span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a><span class="co"># plot densities in a better way to account for the positive skew</span></span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> sum1 <span class="sc">|&gt;</span> </span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">%in%</span> outlier_id)</span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> </span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">%in%</span> outlier_id) <span class="sc">|&gt;</span></span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>pct_change)) <span class="sc">+</span></span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill=</span>state), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">width=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>refClass) <span class="sc">+</span></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"After outlier exclusion"</span>,</span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Percent Change"</span>,</span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Set2"</span>)</span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-247"><a href="#cb30-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-248"><a href="#cb30-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a><span class="fu">## Individual Participant responses</span></span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Facets indicate the Reference class (%, kWh, USD) and the goal % reduction (10%, 15%)</span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>dashed lines also indicate goal percentage - dots on the line indicate participants who met the goal</span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 9</span></span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add geom_vline with x intercept based on pct_goal of the data (which is currently a string of form 10%)</span></span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> </span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(block<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">goal_pct =</span> <span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_remove</span>(pct_goal,<span class="st">"%"</span>))<span class="sc">/</span><span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">reorder</span>(id,pct_change)) <span class="sc">|&gt;</span> </span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>id,<span class="at">x=</span>pct_change)) <span class="sc">+</span> </span>
<span id="cb30-268"><a href="#cb30-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w=</span><span class="dv">0</span>, <span class="at">h=</span><span class="fl">0.17</span>)) <span class="sc">+</span></span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span>goal_pct),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_nested_wrap</span>(refClass<span class="sc">~</span>pct_goal,<span class="at">axes=</span><span class="st">"all"</span>,<span class="at">scales=</span><span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">2</span>)  <span class="sc">+</span> </span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Participant Id"</span>, <span class="at">x=</span><span class="st">"Percent Change"</span>, <span class="at">title=</span><span class="st">"Individual Performance"</span>) <span class="sc">+</span></span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Manrope Light"</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.7</span>)),)</span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interactive data table</span></span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a><span class="co"># plot distribution of reductions by applicance</span></span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a><span class="co"># s2_long |&gt; ggplot(aes(x = change)) + geom_histogram(bins = 30) + facet_wrap(~appliance, scales = "free")</span></span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">refClass=</span><span class="fu">factor</span>(refClass),<span class="at">pct_goal=</span><span class="fu">factor</span>(pct_goal),<span class="at">rounded=</span><span class="fu">factor</span>(rounded),<span class="at">state=</span><span class="fu">factor</span>(state)) <span class="sc">|&gt;</span></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">extensions =</span> <span class="st">'Buttons'</span>,</span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Blfrtip'</span>,</span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">list</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">7</span>,</span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span></span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">'top'</span>) <span class="co"># Add filtering at the top of each column)</span></span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a><span class="co">#DT::datatable(sum1 |&gt; group_by(id,block) |&gt; summarise(diff(total_kWh),diff(orig_kWh)))</span></span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Effects and Interactions</span></span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-302"><a href="#cb30-302" aria-hidden="true" tabindex="-1"></a>**Click on plots to enlarge**</span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> refClass, <span class="at">y =</span> pct_change, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Reference Class"</span>,</span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Reference Class"</span>,</span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Reference Class"</span></span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> pct_change, <span class="at">fill =</span> pct_goal)) <span class="sc">+</span> </span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Goal % Reduction"</span>,</span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Goal % Reduction"</span>,</span>
<span id="cb30-326"><a href="#cb30-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Goal % Reduction"</span></span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rounded, <span class="at">y =</span> pct_change, <span class="at">fill =</span> rounded)) <span class="sc">+</span> </span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Rounding"</span>,</span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Rounding"</span>,</span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Rounding"</span></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-340"><a href="#cb30-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-341"><a href="#cb30-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> pct_change, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Goal % Reduction and Reference Class"</span>,</span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Goal % Reduction"</span>,</span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span> <span class="st">"Reference Class"</span></span>
<span id="cb30-351"><a href="#cb30-351" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> pct_change, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state) <span class="sc">+</span></span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Goal % Reduction and Reference Class - Separated by State"</span>,</span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Goal % Reduction"</span>,</span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span> <span class="st">"Reference Class"</span></span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> pct_change, <span class="at">fill =</span> rounded)) <span class="sc">+</span> </span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rounded) <span class="sc">+</span></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Goal % Reduction and Rounding"</span>,</span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Goal % Reduction"</span>,</span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% Change"</span>,</span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span> <span class="st">"Rounding"</span></span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 11</span></span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-391"><a href="#cb30-391" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a><span class="co">#          block=factor(block)) |&gt;</span></span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(refClass,block,pct_goal) |&gt;</span></span>
<span id="cb30-395"><a href="#cb30-395" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span id="cb30-396"><a href="#cb30-396" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=block)) + </span></span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggforce::facet_col(~pct_goal)</span></span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a><span class="co">#          block=factor(block)) |&gt;</span></span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(refClass,,pct_goal,state) |&gt;</span></span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=pct_goal)) + </span></span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggforce::facet_col(~state)</span></span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100,</span></span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a><span class="co">#          block=factor(block)) |&gt;</span></span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(refClass,,pct_goal,state,goal_pct) |&gt;</span></span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(mean_pct_change = mean(pct_change),se_pct_change = sd(pct_change)/sqrt(n())) |&gt;</span></span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x=mean_pct_change,y=refClass,col=state)) + </span></span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_pointrange(aes(xmin=mean_pct_change-se_pct_change,xmax=mean_pct_change+se_pct_change),position = position_dodge(width=0.5)) +</span></span>
<span id="cb30-421"><a href="#cb30-421" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggforce::facet_col(~pct_goal)</span></span>
<span id="cb30-422"><a href="#cb30-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a>  s2_long <span class="sc">|&gt;</span> </span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(appliance <span class="sc">!=</span> <span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(refClass,appliance,state) <span class="sc">|&gt;</span></span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_kWh_change =</span> <span class="fu">mean</span>(change),<span class="at">se_pct_change =</span> <span class="fu">sd</span>(change)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>())) <span class="sc">|&gt;</span></span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean_kWh_change,<span class="at">y=</span>refClass,<span class="at">col=</span>appliance)) <span class="sc">+</span> </span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>mean_kWh_change<span class="sc">-</span>se_pct_change,<span class="at">xmax=</span>mean_kWh_change<span class="sc">+</span>se_pct_change),<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">facet_col</span>(<span class="sc">~</span>state)</span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> </span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span> <span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>refClass,<span class="at">y=</span>change,<span class="at">fill=</span>state))<span class="sc">+</span></span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb30-440"><a href="#cb30-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>appliance)</span>
<span id="cb30-441"><a href="#cb30-441" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed effects model testing effect of refClass, state, and pct_goal on pct_change</span></span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a><span class="co"># marginal effects plots</span></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(pct_change <span class="sc">~</span> refClass  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>plan<span class="sc">|</span>id) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>state), <span class="at">data =</span> sum1)</span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m1, <span class="fu">c</span>(<span class="st">"refClass"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(pct_change <span class="sc">~</span> pct_goal  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>state), <span class="at">data =</span> sum1)</span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m1, <span class="fu">c</span>(<span class="st">"pct_goal"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(pct_change <span class="sc">~</span> pct_goal<span class="sc">*</span>rounded  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>state), <span class="at">data =</span> sum1)</span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m1, <span class="fu">c</span>(<span class="st">"pct_goal"</span>,<span class="st">"rounded"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(pct_change <span class="sc">~</span> refClass<span class="sc">*</span>pct_goal<span class="sc">*</span>rounded  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>state), <span class="at">data =</span> sum1)</span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m1, <span class="fu">c</span>(<span class="st">"refClass"</span>,<span class="st">"pct_goal"</span>,<span class="st">"rounded"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-472"><a href="#cb30-472" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(pct_change <span class="sc">~</span> state<span class="sc">*</span>pct_goal<span class="sc">*</span>rounded  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> sum1)</span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(m1, <span class="fu">c</span>(<span class="st">"state"</span>,<span class="st">"pct_goal"</span>,<span class="st">"rounded"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- lmer(pct_change ~ refClass*pct_goal*rounded*state  + (1|id), data = sum1)</span></span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a><span class="co"># ggpredict(m1, c("refClass","pct_goal","rounded","state")) |&gt; plot()</span></span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> </span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span> <span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>refClass,<span class="at">y=</span>state_dif,<span class="at">fill=</span>state))<span class="sc">+</span></span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-497"><a href="#cb30-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb30-498"><a href="#cb30-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>appliance)</span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> </span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span> <span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-502"><a href="#cb30-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>state_dif,<span class="at">y=</span>value,<span class="at">col=</span>state))<span class="sc">+</span></span>
<span id="cb30-503"><a href="#cb30-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>appliance)</span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a>sum1 <span class="sc">|&gt;</span> </span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>state_dif,<span class="at">y=</span>pct_change,<span class="at">col=</span>state)) <span class="sc">+</span></span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-512"><a href="#cb30-512" aria-hidden="true" tabindex="-1"></a><span class="co"># compute total kWh reduction, and total % reduction </span></span>
<span id="cb30-513"><a href="#cb30-513" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,refClass,state,pct_goal,rounded,block,plan) <span class="sc">|&gt;</span> </span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span><span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_kWh =</span> <span class="fu">sum</span>(value),<span class="at">orig_kWh=</span><span class="fu">sum</span>(family), <span class="at">total_pct =</span> <span class="fu">sum</span>(value)<span class="sc">/</span><span class="fu">sum</span>(family)) <span class="sc">|&gt;</span></span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> total_pct, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)</span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-520"><a href="#cb30-520" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,refClass,state,pct_goal,rounded) <span class="sc">|&gt;</span> </span>
<span id="cb30-521"><a href="#cb30-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span><span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_kWh =</span> <span class="fu">sum</span>(reduction), <span class="at">total_pct =</span> <span class="fu">sum</span>(reduction)<span class="sc">/</span><span class="fu">sum</span>(family)) <span class="sc">|&gt;</span></span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_goal, <span class="at">y =</span> total_pct, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) </span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,refClass,state,pct_goal,rounded) <span class="sc">|&gt;</span> </span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span><span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_kWh =</span> <span class="fu">sum</span>(reduction), <span class="at">orig_kWh=</span><span class="fu">sum</span>(family), <span class="at">total_pct =</span> <span class="fu">round</span>(<span class="fu">sum</span>(reduction)<span class="sc">/</span><span class="fu">sum</span>(family))) <span class="sc">|&gt;</span></span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> state1, <span class="at">y =</span> total_pct, <span class="at">fill =</span> refClass)) <span class="sc">+</span> </span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pct_goal)</span>
<span id="cb30-535"><a href="#cb30-535" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-536"><a href="#cb30-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a>s2_long <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,refClass,state,pct_goal,rounded,plan) <span class="sc">|&gt;</span> </span>
<span id="cb30-538"><a href="#cb30-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appliance <span class="sc">!=</span><span class="st">"TOTAL"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-539"><a href="#cb30-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_kWh =</span> <span class="fu">sum</span>(reduction), <span class="at">total_pct =</span> <span class="fu">sum</span>(reduction)<span class="sc">/</span><span class="fu">sum</span>(family)) <span class="sc">|&gt;</span></span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> refClass, <span class="at">y =</span> total_pct, <span class="at">fill =</span> pct_goal)) <span class="sc">+</span> </span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(plan<span class="sc">~</span>rounded)</span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(id=reorder(id,pct_change)) |&gt; </span></span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y=id,x=pct_change)) + </span></span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggh4x::facet_nested_wrap(refClass~pct_goal,axes="all",scales="free",ncol=2) </span></span>
<span id="cb30-553"><a href="#cb30-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-554"><a href="#cb30-554" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-555"><a href="#cb30-555" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-556"><a href="#cb30-556" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span id="cb30-557"><a href="#cb30-557" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(id=reorder(id,pct_change)) |&gt; </span></span>
<span id="cb30-558"><a href="#cb30-558" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y=id,x=pct_change,col=refClass)) + </span></span>
<span id="cb30-559"><a href="#cb30-559" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span id="cb30-560"><a href="#cb30-560" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(aes(xintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span id="cb30-561"><a href="#cb30-561" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggh4x::facet_nested_wrap(block~pct_goal,axes="all",scales="free",ncol=2) </span></span>
<span id="cb30-562"><a href="#cb30-562" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-563"><a href="#cb30-563" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-564"><a href="#cb30-564" aria-hidden="true" tabindex="-1"></a><span class="co"># sum1 |&gt; </span></span>
<span id="cb30-565"><a href="#cb30-565" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb30-566"><a href="#cb30-566" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(goal_pct = as.numeric(stringr::str_remove(pct_goal,"%"))/100) |&gt;</span></span>
<span id="cb30-567"><a href="#cb30-567" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x=state,y=pct_change,col=state)) + </span></span>
<span id="cb30-568"><a href="#cb30-568" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size=1,alpha=0.6,position = position_jitter(w=0, h=0.17)) +</span></span>
<span id="cb30-569"><a href="#cb30-569" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_hline(aes(yintercept=goal_pct),linetype="dashed",alpha=.5) +</span></span>
<span id="cb30-570"><a href="#cb30-570" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggdist::stat_halfeye()+</span></span>
<span id="cb30-571"><a href="#cb30-571" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggh4x::facet_nested_wrap(block~pct_goal,axes="all",ncol=2) </span></span>
<span id="cb30-572"><a href="#cb30-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-573"><a href="#cb30-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a><span class="co"># s2_long &lt;- s2 |&gt;</span></span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(</span></span>
<span id="cb30-576"><a href="#cb30-576" aria-hidden="true" tabindex="-1"></a><span class="co">#     cols = c(ACFAMILY1:TOTALAPTWO1),</span></span>
<span id="cb30-577"><a href="#cb30-577" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_to = c(".value", "appliance"),</span></span>
<span id="cb30-578"><a href="#cb30-578" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_pattern = "(.*)(FAMILY1|STATE1|APONE1|APTWO1)$",</span></span>
<span id="cb30-579"><a href="#cb30-579" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_to = "value"</span></span>
<span id="cb30-580"><a href="#cb30-580" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb30-581"><a href="#cb30-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-582"><a href="#cb30-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-583"><a href="#cb30-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-584"><a href="#cb30-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-585"><a href="#cb30-585" aria-hidden="true" tabindex="-1"></a><span class="co"># s2 |&gt; pivot_longer(cols = contains("FAMILY"), names_to = "Family", values_to = "kWh") |&gt; relocate(Family,kWh) |&gt; </span></span>
<span id="cb30-586"><a href="#cb30-586" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = contains("STATE1"), names_to = "State", values_to = "kWh") |&gt; relocate(State)</span></span>
<span id="cb30-587"><a href="#cb30-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-588"><a href="#cb30-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-589"><a href="#cb30-589" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-590"><a href="#cb30-590" aria-hidden="true" tabindex="-1"></a><span class="co"># s2 |&gt; </span></span>
<span id="cb30-591"><a href="#cb30-591" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols=ACFAMILY1:TOTALAPTWO1, names_to = "appliance", values_to = "family") |&gt; relocate(appliance,family)</span></span>
<span id="cb30-592"><a href="#cb30-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-593"><a href="#cb30-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-594"><a href="#cb30-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2024 <a href="https://tegorman13.github.io">Thomas Gorman</a></p>
</div>   
    <div class="nav-footer-center">
<p>site created with <a href="https://cran.r-project.org/">R</a> and <a href="https://quarto.org">quarto</a></p>
<div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/Representation_Study/blob/main/study2.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link active" href="https://github.com/tegorman13/Representation_Study" target="_blank" aria-current="page">
<p><i class="fa-brands fa-github fa-2.0x" aria-label="github"></i></p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","selector":".lightbox","loop":false,"descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>